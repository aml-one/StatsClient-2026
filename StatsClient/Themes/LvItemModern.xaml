<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:converters="clr-namespace:StatsClient.MVVM.Converters"
                    xmlns:viewmodel="clr-namespace:StatsClient.MVVM.ViewModel"
                    xmlns:core="clr-namespace:StatsClient.MVVM.Core"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
                    mc:Ignorable="d"
                    x:Class="StatsClient.Themes.LvItemModern">


    <converters:EmptyToHiddenConverter x:Key="EmptyToHiddenConverter" />
    <converters:EmptyToCollapsedConverter x:Key="EmptyToCollapsedConverter" />
    <converters:CleanUpDesignedByStringConverter x:Key="CleanUpDesignedByStringConverter" />
    <converters:EmptyTextToVisibleConverter x:Key="EmptyTextToVisibleConverter" />
    <converters:EqualToHiddenConverter x:Key="EqualToHiddenConverter" />
    <converters:StringToImageConverter x:Key="StringToImageConverter" />
    <converters:AgeToColorConverter x:Key="AgeToColorConverter" />


    <converters:RushToVisibleConverter x:Key="RushToVisibleConverter" />
    <converters:CommentIconToVisibleConverter x:Key="CommentIconToVisibleConverter" />
    <converters:RemoveFirstCharFromStringIfItsZConverter x:Key="RemoveFirstCharFromStringIfItsZConverter" />
    <converters:TextToVisibilityConverter x:Key="TextToVisibilityConverter" />
    <converters:IdiomToImageConverter x:Key="IdiomToImageConverter" />
    <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    <converters:BoolToInverseVisibilityConverter x:Key="BoolToInverseVisibilityConverter" />
    <converters:EqualToCollapsedVisibilityConverter x:Key="EqualToCollapsedVisibilityConverter" />
    <converters:DarkColorBoolToColorConverter x:Key="DarkColorBoolToColorConverter" />
    <converters:AppNameToIconConverter x:Key="AppNameToIconConverter" />
    <converters:EmptyAppNameToCollapsedConverter x:Key="EmptyAppNameToCollapsedConverter" />
    <converters:EmptyAppNameToVisibleConverter x:Key="EmptyAppNameToVisibleConverter" />
    <converters:EmailToWebsiteConverter x:Key="EmailToWebsiteConverter" />
    <converters:ServiceStatusToIconConverter x:Key="ServiceStatusToIconConverter" />
    <converters:DateToMinutesConverter x:Key="DateToMinutesConverter" />
    <converters:OrderByToColorConverter x:Key="OrderByToColorConverter" />
    <converters:AgeToGlowConverter x:Key="AgeToGlowConverter" />
    <converters:AgeToGlowForAgeConverter x:Key="AgeToGlowForAgeConverter" />

    <converters:Double8ToMultiplyConverter x:Key="Double8ToMultiplyConverter" />
    <converters:Double10ToMultiplyConverter x:Key="Double10ToMultiplyConverter" />
    <converters:Double12ToMultiplyConverter x:Key="Double12ToMultiplyConverter" />
    <converters:AgeSecondsToCollapsedVisibilityConverter x:Key="AgeSecondsToCollapsedVisibilityConverter" />
    <converters:IncostistencyToColorConverterConverter x:Key="IncostistencyToColorConverterConverter" />
    <converters:IncostistencyToVisibilityVisibleConverterConverter x:Key="IncostistencyToVisibilityVisibleConverterConverter" />
    <converters:IncostistencyToVisibilityCollapsedConverterConverter x:Key="IncostistencyToVisibilityCollapsedConverterConverter" />
    <converters:EventColorToColorConverter x:Key="EventColorToColorConverter" />
    <converters:ProcessStatusIDToReadableStateConverter x:Key="ProcessStatusIDToReadableStateConverter" />





    <!-- LvItemFolderSubscription -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemFolderSubscription">

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="MouseDown">
                                <i:InvokeCommandAction Command="{Binding DataContext.FsItemClickedCommand, 
                                                                 RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                       CommandParameter="{Binding .}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=fsIcon, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=fsName, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=fsLastModified, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=fsAge, Path=Width}" />
                            </Grid.ColumnDefinitions>


                            <StackPanel Orientation="Horizontal">
                                <Ellipse Width="22"
                                         Height="22"
                                         Margin="0,0,0,0"
                                         Grid.Column="0"
                                         VerticalAlignment="Center">
                                    <Ellipse.Fill>
                                        <ImageBrush ImageSource="/Images/folder.png" />
                                    </Ellipse.Fill>
                                </Ellipse>

                            </StackPanel>

                            <TextBlock Text="{Binding FolderName}"
                                       Grid.Column="1"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       FontSize="12"
                                       Foreground="{Binding AgeForColoring, Converter={StaticResource AgeToColorConverter}}"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />




                            <TextBlock Text="{Binding LastModified}"
                                       Grid.Column="2"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       FontSize="12"
                                       Foreground="{Binding AgeForColoring, Converter={StaticResource AgeToColorConverter}}"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />

                            <TextBlock Text="{Binding Age}"
                                       Grid.Column="3"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       FontSize="12"
                                       Foreground="{Binding AgeForColoring, Converter={StaticResource AgeToColorConverter}}"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />



                        </Grid>

                    </Border>


                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter Property="BorderBrush"
                                    Value="#79bbf2"
                                    TargetName="Item" />
                            <Setter Property="Background"
                                    Value="AliceBlue"
                                    TargetName="Item" />
                            <Setter Property="Cursor"
                                    Value="Hand"
                                    TargetName="Item" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>


    </Style>

    <!-- LvItemImportHistory -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemImportHistory">

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1"
                            BorderBrush="AliceBlue"
                            Margin="5"
                            Padding="2"
                            CornerRadius="7"
                            Background="#99DDDDDD">
                        <Border.BitmapEffect>
                            <DropShadowBitmapEffect Color="#444444"
                                                    Direction="270"
                                                    ShadowDepth="1"
                                                    Opacity="0.35"
                                                    Softness="5" />
                        </Border.BitmapEffect>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="0">
                                <core:OutlinedTextBlock Stroke="{Binding DateTime, Converter={StaticResource OrderByToColorConverter}}"
                                                        StrokePosition="Outside"
                                                        FontSize="24"
                                                        FontWeight="SemiBold"
                                                        Fill="Black"
                                                        StrokeThickness="2"
                                                        Text="{Binding OrderID}"
                                                        VerticalAlignment="Center"
                                                        Margin="5,0,0,0" />

                                <StackPanel Orientation="Vertical"
                                            Grid.Row="1"
                                            VerticalAlignment="Center"
                                            Margin="10,-7,0,0"
                                            HorizontalAlignment="Right">


                                    <core:OutlinedTextBlock Stroke="Black"
                                                            Grid.Column="1"
                                                            Grid.RowSpan="2"
                                                            StrokePosition="Outside"
                                                            FontSize="11"
                                                            FontWeight="SemiBold"
                                                            Fill="Navy"
                                                            VerticalAlignment="Center"
                                                            StrokeThickness="0.5"
                                                            Text="{Binding Event}"
                                                            Margin="5,0,0,-8" />

                                    <core:OutlinedTextBlock Stroke="Black"
                                                            Grid.Column="1"
                                                            Grid.RowSpan="2"
                                                            StrokePosition="Outside"
                                                            FontSize="20"
                                                            FontWeight="SemiBold"
                                                            Fill="LightGreen"
                                                            VerticalAlignment="Center"
                                                            StrokeThickness="0.85"
                                                            Text="{Binding FriendlyName}"
                                                            Margin="5,0,0,0" />

                                </StackPanel>
                            </StackPanel>


                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="1"
                                        Grid.RowSpan="2"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Right">

                                <core:OutlinedTextBlock Stroke="{Binding DateTime, Converter={StaticResource AgeToGlowForAgeConverter}}"
                                                        Grid.Column="1"
                                                        Grid.RowSpan="2"
                                                        StrokePosition="Outside"
                                                        FontSize="20"
                                                        FontWeight="SemiBold"
                                                        Fill="Black"
                                                        VerticalAlignment="Center"
                                                        StrokeThickness="1"
                                                        Text="{Binding Age}"
                                                        Margin="5,0,10,0" />
                                <core:OutlinedTextBlock Stroke="{Binding DateTime, Converter={StaticResource AgeToGlowConverter}}"
                                                        Grid.Column="1"
                                                        Grid.RowSpan="2"
                                                        StrokePosition="Outside"
                                                        FontSize="30"
                                                        FontWeight="SemiBold"
                                                        Fill="Black"
                                                        StrokeThickness="2"
                                                        Text="{Binding ImportTime}"
                                                        VerticalAlignment="Center"
                                                        HorizontalAlignment="Right"
                                                        Margin="5,0,10,0" />
                            </StackPanel>

                        </Grid>

                    </Border>



                </ControlTemplate>
            </Setter.Value>
        </Setter>


    </Style>

    <!-- LvItemExportHistory -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemExportHistory">

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1"
                            BorderBrush="AliceBlue"
                            Margin="5"
                            Padding="2"
                            CornerRadius="7"
                            Background="#99DDDDDD">
                        <Border.BitmapEffect>
                            <DropShadowBitmapEffect Color="#444444"
                                                    Direction="270"
                                                    ShadowDepth="1"
                                                    Opacity="0.35"
                                                    Softness="5" />
                        </Border.BitmapEffect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="0">
                                <core:OutlinedTextBlock Stroke="LightSteelBlue"
                                                        StrokePosition="Outside"
                                                        FontSize="18"
                                                        FontWeight="SemiBold"
                                                        Fill="Black"
                                                        StrokeThickness="2"
                                                        Text="{Binding OrderID}"
                                                        VerticalAlignment="Bottom"
                                                        Margin="5,0,0,0" />

                            </StackPanel>
                            <StackPanel Orientation="Horizontal"
                                        Grid.Row="1"
                                        Margin="0,-5,0,0"
                                        HorizontalAlignment="Right">
                                <TextBlock Text="{Binding Event}"
                                           FontWeight="Normal"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Center"
                                           Foreground="#222"
                                           FontSize="11"
                                           Margin="5,0,0,0"
                                           TextTrimming="CharacterEllipsis" />

                                <TextBlock Text="{Binding FriendlyName}"
                                           FontWeight="SemiBold"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Center"
                                           Foreground="DarkGreen"
                                           FontSize="12"
                                           Margin="5,0,0,0"
                                           TextTrimming="CharacterEllipsis" />

                            </StackPanel>



                            <core:OutlinedTextBlock Stroke="LightBlue"
                                                    Grid.Column="1"
                                                    Grid.RowSpan="2"
                                                    StrokePosition="Outside"
                                                    FontSize="26"
                                                    FontWeight="SemiBold"
                                                    Fill="Black"
                                                    StrokeThickness="2"
                                                    Text="{Binding ExportTime}"
                                                    VerticalAlignment="Center"
                                                    HorizontalAlignment="Right"
                                                    Margin="5,0,10,0" />

                        </Grid>

                    </Border>



                </ControlTemplate>
            </Setter.Value>
        </Setter>


    </Style>

    <!-- LvItemPendingDigitalCases -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemPendingDigitalCases">

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=pdPanNumber, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=pdIsCollected, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=pdIsProcessed, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=pbProcessedBy, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=pbProcessedTime, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=pbPostedBy, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=pbPostedTime, Path=Width}" />
                            </Grid.ColumnDefinitions>


                            <TextBlock Text="{Binding PanNumber}"
                                       Grid.Column="0"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Foreground="{Binding LineColor}"
                                       FontSize="14"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />

                            <TextBlock Text="{Binding IsCollected}"
                                       Grid.Column="1"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Foreground="{Binding LineColor}"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />

                            <TextBlock Text="{Binding IsProcessed}"
                                       Grid.Column="2"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Foreground="{Binding LineColor}"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />

                            <TextBlock Text="{Binding ProcessedBy}"
                                       Grid.Column="3"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Foreground="{Binding LineColor}"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />


                            <TextBlock Text="{Binding ProcessedTime}"
                                       Grid.Column="4"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Foreground="{Binding LineColor}"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />


                            <TextBlock Text="{Binding PostedBy}"
                                       Grid.Column="5"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Foreground="{Binding LineColor}"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />

                            <TextBlock Text="{Binding PostedTime}"
                                       Grid.Column="6"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Foreground="{Binding LineColor}"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />


                        </Grid>

                    </Border>



                </ControlTemplate>
            </Setter.Value>
        </Setter>


    </Style>

    <!-- LvItemDetailed -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemDetailed">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1"
                            Tag="{Binding IntOrderID}">

                        <Border.ContextMenu>
                            <ContextMenu Opened="ContextMenu_Opened"
                                         Closed="ContextMenu_Closed">
                                <MenuItem Header="{Binding IntOrderID}"
                                          IsEnabled="False">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/id.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator />

                                <MenuItem Header="View order"
                                          Click="MenuItemOpenUpOrderInfoWindow_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/open.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator />

                                <MenuItem Header="Rename"
                                          Visibility="{Binding CanBeRenamed, Converter={StaticResource BoolToVisibilityConverter}}"
                                          Click="MenuItemOpenUpRenameOrderWindow_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/rename.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <MenuItem Header="Generate StCopy"
                                          Visibility="{Binding CanGenerateStCopy, Converter={StaticResource BoolToVisibilityConverter}}"
                                          Click="MenuItemGenerateStCopy_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/stcopy.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <MenuItem Header="Set shade to"
                                          Visibility="{Binding Shade, Converter={StaticResource EmptyTextToVisibleConverter}}">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/update.png" />
                                    </MenuItem.Icon>
                                    <MenuItem Header="VITA">
                                        <MenuItem Header="A1"
                                                  Click="Shade_A1_Click" />
                                        <MenuItem Header="A2"
                                                  Click="Shade_A2_Click" />
                                        <MenuItem Header="A3"
                                                  Click="Shade_A3_Click" />
                                        <MenuItem Header="A3.5"
                                                  Click="Shade_A35_Click" />
                                        <MenuItem Header="A4"
                                                  Click="Shade_A4_Click" />
                                        <Separator />
                                        <MenuItem Header="B1"
                                                  Click="Shade_B1_Click" />
                                        <MenuItem Header="B2"
                                                  Click="Shade_B2_Click" />
                                        <MenuItem Header="B3"
                                                  Click="Shade_B3_Click" />
                                        <MenuItem Header="B4"
                                                  Click="Shade_B4_Click" />
                                        <Separator />
                                        <MenuItem Header="C1"
                                                  Click="Shade_C1_Click" />
                                        <MenuItem Header="C2"
                                                  Click="Shade_C2_Click" />
                                        <MenuItem Header="C3"
                                                  Click="Shade_C3_Click" />
                                        <MenuItem Header="C4"
                                                  Click="Shade_C4_Click" />
                                        <Separator />
                                        <MenuItem Header="D2"
                                                  Click="Shade_D2_Click" />
                                        <MenuItem Header="D3"
                                                  Click="Shade_D3_Click" />
                                        <MenuItem Header="D4"
                                                  Click="Shade_D4_Click" />
                                    </MenuItem>
                                    <MenuItem Header="VITA 3D">
                                        <MenuItem Header="1M1"
                                                  Click="Shade_1M1_Click" />
                                        <MenuItem Header="1M2"
                                                  Click="Shade_1M2_Click" />
                                        <Separator />
                                        <MenuItem Header="2M1"
                                                  Click="Shade_2M1_Click" />
                                        <MenuItem Header="2M2"
                                                  Click="Shade_2M2_Click" />
                                        <MenuItem Header="2M3"
                                                  Click="Shade_2M3_Click" />
                                        <Separator />
                                        <MenuItem Header="3M1"
                                                  Click="Shade_3M1_Click" />
                                        <MenuItem Header="3M2"
                                                  Click="Shade_3M2_Click" />
                                        <MenuItem Header="3M3"
                                                  Click="Shade_3M3_Click" />
                                        <Separator />
                                        <MenuItem Header="4M1"
                                                  Click="Shade_4M1_Click" />
                                        <MenuItem Header="4M2"
                                                  Click="Shade_4M2_Click" />
                                        <MenuItem Header="4M3"
                                                  Click="Shade_4M3_Click" />
                                        <Separator />
                                        <MenuItem Header="5M1"
                                                  Click="Shade_5M1_Click" />
                                        <MenuItem Header="5M2"
                                                  Click="Shade_5M2_Click" />
                                        <MenuItem Header="5M3"
                                                  Click="Shade_5M3_Click" />
                                        <Separator />
                                        <MenuItem Header="2L1.5"
                                                  Click="Shade_2L15_Click" />
                                        <MenuItem Header="2L2.5"
                                                  Click="Shade_2L25_Click" />
                                        <MenuItem Header="3L1.5"
                                                  Click="Shade_3L15_Click" />
                                        <MenuItem Header="3L2.5"
                                                  Click="Shade_3L25_Click" />
                                        <MenuItem Header="4L1.5"
                                                  Click="Shade_4L15_Click" />
                                        <MenuItem Header="4L2.5"
                                                  Click="Shade_4L25_Click" />
                                        <Separator />
                                        <MenuItem Header="2R1.5"
                                                  Click="Shade_2R15_Click" />
                                        <MenuItem Header="2R2.5"
                                                  Click="Shade_2R25_Click" />
                                        <MenuItem Header="3R1.5"
                                                  Click="Shade_3R15_Click" />
                                        <MenuItem Header="3R2.5"
                                                  Click="Shade_3R25_Click" />
                                        <MenuItem Header="4R1.5"
                                                  Click="Shade_4R15_Click" />
                                        <MenuItem Header="4R2.5"
                                                  Click="Shade_4R25_Click" />
                                    </MenuItem>
                                    <MenuItem Header="Bleach / White">
                                        <MenuItem Header="0M1"
                                                  Click="Shade_0M1_Click" />
                                        <MenuItem Header="0M2"
                                                  Click="Shade_0M2_Click" />
                                        <MenuItem Header="0M3"
                                                  Click="Shade_0M3_Click" />
                                        <MenuItem Header="0M4"
                                                  Click="Shade_0M4_Click" />
                                        <Separator />
                                        <MenuItem Header="BL1"
                                                  Click="Shade_BL1_Click" />
                                        <MenuItem Header="BL2"
                                                  Click="Shade_BL2_Click" />
                                        <MenuItem Header="BL3"
                                                  Click="Shade_BL3_Click" />
                                        <MenuItem Header="BL4"
                                                  Click="Shade_BL4_Click" />
                                        <Separator />
                                        <MenuItem Header="010"
                                                  Click="Shade_010_Click" />
                                        <MenuItem Header="020"
                                                  Click="Shade_020_Click" />
                                        <MenuItem Header="030"
                                                  Click="Shade_030_Click" />
                                        <MenuItem Header="040"
                                                  Click="Shade_040_Click" />
                                    </MenuItem>

                                </MenuItem>

                                <MenuItem Header="Explore order folder"
                                          Click="MenuItemExploreFolder_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/folder.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator Visibility="{Binding HasDesignerHistory, Converter={StaticResource BoolToVisibilityConverter}}" />

                                <MenuItem Header="Designer History"
                                          ItemsSource="{Binding DesignerHistory}"
                                          Visibility="{Binding HasDesignerHistory, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ListViewIcons/psModelled.png" />
                                    </MenuItem.Icon>
                                    <MenuItem.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="32" />
                                                    <ColumnDefinition Width="38" />
                                                    <ColumnDefinition Width="36" />
                                                    <ColumnDefinition Width="52" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Text="{Binding Year}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           Grid.Column="0" />

                                                <TextBlock Text="{Binding Date}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           Margin="4,0,0,0"
                                                           Grid.Column="1" />

                                                <TextBlock Text="{Binding Day}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           HorizontalAlignment="Center"
                                                           Grid.Column="2" />

                                                <TextBlock Text="{Binding Time}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           HorizontalAlignment="Right"
                                                           Grid.Column="3" />

                                                <TextBlock Text="{Binding DesignerName}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="SemiBold"
                                                           Margin="16,0,0,0"
                                                           Grid.Column="4" />
                                            </Grid>
                                        </DataTemplate>
                                    </MenuItem.ItemTemplate>
                                </MenuItem>


                            </ContextMenu>
                        </Border.ContextMenu>

                        <Border.InputBindings>
                            <MouseBinding Gesture="LeftDoubleClick"
                                          Command="{Binding DataContext.OpenUpOrderInfoWindowCommand, 
                                                            RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                        </Border.InputBindings>
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="PreviewMouseLeftButtonDown">
                                <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, 
                                                             RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                       CommandParameter="{Binding .}" />
                            </i:EventTrigger>
                            <i:EventTrigger EventName="PreviewMouseRightButtonDown">
                                <i:InvokeCommandAction Command="{Binding DataContext.ItemRightClickedCommand, 
                                                             RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                       CommandParameter="{Binding .}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=headerIcon, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerCaseID, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerPrescription, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerShade, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerScanInfo, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerCustomer, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerItems, Path=Width}" />
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal"
                                        Margin="0,2,0,2">
                                <Border BorderBrush="#F5F5F5"
                                        BorderThickness="1"
                                        x:Name="brdPanColor">

                                    <Rectangle Width="12"
                                               Height="auto"
                                               Margin="0,0,0,0"
                                               x:Name="rctPanColor">
                                        <Rectangle.Fill>
                                            <SolidColorBrush Color="{Binding PanColor}" />
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Border>

                                <Ellipse Width="28"
                                         Height="28"
                                         Margin="3,0,2,0"
                                         Grid.Column="0"
                                         VerticalAlignment="Top"
                                         x:Name="Icon">
                                    <Ellipse.Fill>
                                        <ImageBrush ImageSource="{Binding ImageSource}"
                                                    RenderOptions.BitmapScalingMode="Fant" />
                                    </Ellipse.Fill>
                                </Ellipse>
                            </StackPanel>



                            <!-- OrderID & Creation/Modification dates -->
                            <StackPanel VerticalAlignment="Top"
                                        Height="32"
                                        Grid.Column="1"
                                        Margin="4,0,10,0">
                                <StackPanel Orientation="Vertical"
                                            Margin="0,2,0,0">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding IntOrderID}"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center"
                                                   FontSize="12"
                                                   Foreground="Black"
                                                   TextTrimming="CharacterEllipsis" />
                                        <TextBlock d:Text="(tool tip text)"
                                                   x:Name="ToolTipText"
                                                   FontSize="9"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="5,0,0,0" />

                                    </StackPanel>


                                    <StackPanel Orientation="Horizontal"
                                                Margin="0,1,0,0">


                                        <Label Content="Created:"
                                               FontSize="8"
                                               Foreground="DarkGreen"
                                               FontWeight="Normal"
                                               Padding="0,0,4,0" />
                                        <TextBlock Text="{Binding MaxCreateDateFriendly}"
                                                   Foreground="#44474D"
                                                   FontSize="8"
                                                   VerticalAlignment="Center"
                                                   TextWrapping="WrapWithOverflow" />

                                        <Label Content="Modified:"
                                               FontSize="8"
                                               Foreground="SteelBlue"
                                               FontWeight="Normal"
                                               x:Name="lblModified"
                                               Padding="8,0,4,0"
                                               Visibility="{Binding ModificationDate, Converter={StaticResource EmptyToCollapsedConverter}}" />
                                        <TextBlock Text="{Binding ModificationDate}"
                                                   x:Name="tbModificationDate"
                                                   Foreground="#44474D"
                                                   FontSize="8"
                                                   FontWeight="Normal"
                                                   VerticalAlignment="Center"
                                                   Visibility="{Binding ModificationDate, Converter={StaticResource EmptyToCollapsedConverter}}"
                                                   TextWrapping="WrapWithOverflow" />

                                        <Label Content="Designed By:"
                                               FontSize="8"
                                               Foreground="DarkGoldenrod"
                                               FontWeight="Normal"
                                               Padding="8,0,4,0"
                                               Visibility="{Binding ExtOrderID, Converter={StaticResource EmptyToCollapsedConverter}}" />
                                        <TextBlock Text="{Binding ExtOrderID}"
                                                   Foreground="#44474D"
                                                   FontSize="8"
                                                   FontWeight="Normal"
                                                   VerticalAlignment="Center"
                                                   Visibility="{Binding ExtOrderID, Converter={StaticResource EmptyToCollapsedConverter}}"
                                                   TextWrapping="WrapWithOverflow" />

                                    </StackPanel>

                                </StackPanel>
                            </StackPanel>


                            <!-- Prescription / Image icon -->
                            <StackPanel Grid.Column="2"
                                        VerticalAlignment="Center">
                                <Image Source="\Images\ListViewIcons\image.png"
                                       Width="21"
                                       Height="22"
                                       ToolTip="This order has images / rx form"
                                       Visibility="{Binding HasAnyImage, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>

                            <!-- Shade -->
                            <Grid Grid.Column="3"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Center">
                                <TextBlock Text="{Binding Shade}"
                                           Foreground="Black"
                                           FontWeight="SemiBold"
                                           VerticalAlignment="Center"
                                           FontSize="10"
                                           Margin="5,0,0,0"
                                           TextTrimming="CharacterEllipsis" />
                            </Grid>

                            <!-- Scanner Info & Other -->
                            <StackPanel Grid.Column="4"
                                        VerticalAlignment="Top">
                                <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,0">

                                    <Label Content="Scan source:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Margin="3,0,3,0"
                                           Padding="0"
                                           Visibility="{Binding ScanSourceFriendlyName, Converter={StaticResource EmptyToHiddenConverter}}" />

                                    <TextBlock Text="{Binding ScanSourceFriendlyName}"
                                               Foreground="#44474D"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbScanSource" />
                                </StackPanel>

                                <StackPanel Orientation="Horizontal"
                                            Margin="3,-1,0,0">
                                    <Label Content="Scan date:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Margin="7,0,3,0"
                                           Padding="0"
                                           Visibility="{Binding CacheMaxScanDateFriendly, Converter={StaticResource EmptyToHiddenConverter}}" />
                                    <TextBlock Text="{Binding CacheMaxScanDateFriendly}"
                                               Foreground="#44474D"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbCacheMaxScanDate" />
                                </StackPanel>

                                <StackPanel Orientation="Horizontal"
                                            Margin="0,-1,0,00">
                                    <Label Content="Last touched:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Margin="0,0,3,0"
                                           Padding="0"
                                           Visibility="{Binding LastModifiedComputerName, Converter={StaticResource EmptyToHiddenConverter}}" />
                                    <TextBlock Text="{Binding LastModifiedComputerName}"
                                               x:Name="tbLastTouchedBy"
                                               Foreground="#300300"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               TextTrimming="CharacterEllipsis" />
                                </StackPanel>



                            </StackPanel>

                            <!-- Customer & Patient info -->
                            <StackPanel Orientation="Vertical"
                                        Grid.Column="5"
                                        Margin="5,0,10,0"
                                        VerticalAlignment="Top">
                                <TextBlock Text="{Binding Customer}"
                                           Foreground="Black"
                                           FontWeight="SemiBold"
                                           TextWrapping="WrapWithOverflow"
                                           Margin="0,0,0,0"
                                           Padding="0"
                                           VerticalAlignment="Top" />


                                <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,0"
                                            VerticalAlignment="Bottom">
                                    <Label Content="Patient:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Foreground="#666666"
                                           Margin="0,1,3,0"
                                           Padding="0" />
                                    <TextBlock Text="{Binding Patient_FirstName}"
                                               Foreground="#111111"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               FontWeight="SemiBold"
                                               Margin="0,1,0,0"
                                               TextWrapping="WrapWithOverflow" />

                                    <TextBlock Text="{Binding Patient_LastName}"
                                               Foreground="#111111"
                                               FontSize="8"
                                               Margin="5,1,0,0"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow" />



                                </StackPanel>
                            </StackPanel>






                            <!-- Items & Manufacturers -->
                            <StackPanel Grid.Column="6"
                                        VerticalAlignment="Top"
                                        Margin="5,0,0,0">
                                <TextBlock Text="{Binding Items}"
                                           Foreground="Black"
                                           VerticalAlignment="Top"
                                           Margin="0,0,0,0"
                                           Padding="0"
                                           TextTrimming="CharacterEllipsis" />
                                <StackPanel Orientation="Horizontal"
                                            Margin="0,2,0,0">
                                    <TextBlock Text="{Binding CacheMaterialName}"
                                               Foreground="#3f793f"
                                               FontSize="9"
                                               TextTrimming="CharacterEllipsis"
                                               x:Name="tbCacheMaterialName" />
                                    <TextBlock Text="{Binding ManufName}"
                                               Foreground="#8d8d3d"
                                               FontSize="9"
                                               Margin="5,0,0,0"
                                               TextTrimming="CharacterEllipsis"
                                               x:Name="tbManufName" />
                                </StackPanel>


                            </StackPanel>


                        </Grid>
                    </Border>


                    <ControlTemplate.Triggers>
                        <Trigger Property="ItemsControl.AlternationIndex"
                                 Value="1">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#f7fefe" />
                        </Trigger>


                        <DataTrigger Binding="{Binding PreviouslyDesigned}"
                                     Value="True">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#dff2f7" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Previously designed!" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Blue" />
                            <Setter TargetName="brdPanColor"
                                    Property="BorderBrush"
                                    Value="Transparent" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding PanColor}"
                                     Value="Transparent">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#edfff6" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Pan is not registered!" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Green" />
                            <Setter TargetName="brdPanColor"
                                    Property="BorderBrush"
                                    Value="Transparent" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding PanNumber}"
                                     Value="">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#ffffe9" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="There is no pan number set!" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Orange" />
                            <Setter TargetName="brdPanColor"
                                    Property="BorderBrush"
                                    Value="Transparent" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding AlternateColoring}"
                                     Value="encode">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#ffedff" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Possible encode case" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Red" />
                            <Setter TargetName="tbManufName"
                                    Property="Foreground"
                                    Value="Red" />
                            <Setter TargetName="tbCacheMaterialName"
                                    Property="Foreground"
                                    Value="Maroon" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding AlternateColoring}"
                                     Value="noshade">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#fffccc" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Could not determine the shade" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Red" />
                        </DataTrigger>

                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter Property="BorderBrush"
                                    Value="#79bbf2"
                                    TargetName="Item" />
                            <Setter Property="BorderThickness"
                                    Value="1"
                                    TargetName="Item" />
                            <Setter Property="Background"
                                    Value="#d4e9fb"
                                    TargetName="Item" />
                            <Setter Property="Cursor"
                                    Value="Hand"
                                    TargetName="Item" />
                        </Trigger>



                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <!-- LvItemDetailedNew -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemDetailedNew">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1"
                            Tag="{Binding IntOrderID}">

                        <Border.ContextMenu>
                            <ContextMenu Opened="ContextMenu_Opened"
                                         Closed="ContextMenu_Closed">
                                <MenuItem Header="{Binding IntOrderID}"
                                          IsEnabled="False">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/id.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator />

                                <MenuItem Header="View order"
                                          Click="MenuItemOpenUpOrderInfoWindow_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/open.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator />

                                <MenuItem Header="Rename"
                                          Visibility="{Binding CanBeRenamed, Converter={StaticResource BoolToVisibilityConverter}}"
                                          Click="MenuItemOpenUpRenameOrderWindow_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/rename.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <MenuItem Header="Generate StCopy"
                                          Visibility="{Binding CanGenerateStCopy, Converter={StaticResource BoolToVisibilityConverter}}"
                                          Click="MenuItemGenerateStCopy_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/stcopy.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <MenuItem Header="Set shade to"
                                          Visibility="{Binding Shade, Converter={StaticResource EmptyTextToVisibleConverter}}">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/update.png" />
                                    </MenuItem.Icon>
                                    <MenuItem Header="VITA">
                                        <MenuItem Header="A1"
                                                  Click="Shade_A1_Click" />
                                        <MenuItem Header="A2"
                                                  Click="Shade_A2_Click" />
                                        <MenuItem Header="A3"
                                                  Click="Shade_A3_Click" />
                                        <MenuItem Header="A3.5"
                                                  Click="Shade_A35_Click" />
                                        <MenuItem Header="A4"
                                                  Click="Shade_A4_Click" />
                                        <Separator />
                                        <MenuItem Header="B1"
                                                  Click="Shade_B1_Click" />
                                        <MenuItem Header="B2"
                                                  Click="Shade_B2_Click" />
                                        <MenuItem Header="B3"
                                                  Click="Shade_B3_Click" />
                                        <MenuItem Header="B4"
                                                  Click="Shade_B4_Click" />
                                        <Separator />
                                        <MenuItem Header="C1"
                                                  Click="Shade_C1_Click" />
                                        <MenuItem Header="C2"
                                                  Click="Shade_C2_Click" />
                                        <MenuItem Header="C3"
                                                  Click="Shade_C3_Click" />
                                        <MenuItem Header="C4"
                                                  Click="Shade_C4_Click" />
                                        <Separator />
                                        <MenuItem Header="D2"
                                                  Click="Shade_D2_Click" />
                                        <MenuItem Header="D3"
                                                  Click="Shade_D3_Click" />
                                        <MenuItem Header="D4"
                                                  Click="Shade_D4_Click" />
                                    </MenuItem>
                                    <MenuItem Header="VITA 3D">
                                        <MenuItem Header="1M1"
                                                  Click="Shade_1M1_Click" />
                                        <MenuItem Header="1M2"
                                                  Click="Shade_1M2_Click" />
                                        <Separator />
                                        <MenuItem Header="2M1"
                                                  Click="Shade_2M1_Click" />
                                        <MenuItem Header="2M2"
                                                  Click="Shade_2M2_Click" />
                                        <MenuItem Header="2M3"
                                                  Click="Shade_2M3_Click" />
                                        <Separator />
                                        <MenuItem Header="3M1"
                                                  Click="Shade_3M1_Click" />
                                        <MenuItem Header="3M2"
                                                  Click="Shade_3M2_Click" />
                                        <MenuItem Header="3M3"
                                                  Click="Shade_3M3_Click" />
                                        <Separator />
                                        <MenuItem Header="4M1"
                                                  Click="Shade_4M1_Click" />
                                        <MenuItem Header="4M2"
                                                  Click="Shade_4M2_Click" />
                                        <MenuItem Header="4M3"
                                                  Click="Shade_4M3_Click" />
                                        <Separator />
                                        <MenuItem Header="5M1"
                                                  Click="Shade_5M1_Click" />
                                        <MenuItem Header="5M2"
                                                  Click="Shade_5M2_Click" />
                                        <MenuItem Header="5M3"
                                                  Click="Shade_5M3_Click" />
                                        <Separator />
                                        <MenuItem Header="2L1.5"
                                                  Click="Shade_2L15_Click" />
                                        <MenuItem Header="2L2.5"
                                                  Click="Shade_2L25_Click" />
                                        <MenuItem Header="3L1.5"
                                                  Click="Shade_3L15_Click" />
                                        <MenuItem Header="3L2.5"
                                                  Click="Shade_3L25_Click" />
                                        <MenuItem Header="4L1.5"
                                                  Click="Shade_4L15_Click" />
                                        <MenuItem Header="4L2.5"
                                                  Click="Shade_4L25_Click" />
                                        <Separator />
                                        <MenuItem Header="2R1.5"
                                                  Click="Shade_2R15_Click" />
                                        <MenuItem Header="2R2.5"
                                                  Click="Shade_2R25_Click" />
                                        <MenuItem Header="3R1.5"
                                                  Click="Shade_3R15_Click" />
                                        <MenuItem Header="3R2.5"
                                                  Click="Shade_3R25_Click" />
                                        <MenuItem Header="4R1.5"
                                                  Click="Shade_4R15_Click" />
                                        <MenuItem Header="4R2.5"
                                                  Click="Shade_4R25_Click" />
                                    </MenuItem>
                                    <MenuItem Header="Bleach / White">
                                        <MenuItem Header="0M1"
                                                  Click="Shade_0M1_Click" />
                                        <MenuItem Header="0M2"
                                                  Click="Shade_0M2_Click" />
                                        <MenuItem Header="0M3"
                                                  Click="Shade_0M3_Click" />
                                        <MenuItem Header="0M4"
                                                  Click="Shade_0M4_Click" />
                                        <Separator />
                                        <MenuItem Header="BL1"
                                                  Click="Shade_BL1_Click" />
                                        <MenuItem Header="BL2"
                                                  Click="Shade_BL2_Click" />
                                        <MenuItem Header="BL3"
                                                  Click="Shade_BL3_Click" />
                                        <MenuItem Header="BL4"
                                                  Click="Shade_BL4_Click" />
                                        <Separator />
                                        <MenuItem Header="010"
                                                  Click="Shade_010_Click" />
                                        <MenuItem Header="020"
                                                  Click="Shade_020_Click" />
                                        <MenuItem Header="030"
                                                  Click="Shade_030_Click" />
                                        <MenuItem Header="040"
                                                  Click="Shade_040_Click" />
                                    </MenuItem>

                                </MenuItem>

                                <MenuItem Header="Explore order folder"
                                          Click="MenuItemExploreFolder_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/folder.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator Visibility="{Binding HasDesignerHistory, Converter={StaticResource BoolToVisibilityConverter}}" />

                                <MenuItem Header="Designer History"
                                          ItemsSource="{Binding DesignerHistory}"
                                          Visibility="{Binding HasDesignerHistory, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ListViewIcons/psModelled.png" />
                                    </MenuItem.Icon>
                                    <MenuItem.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="32" />
                                                    <ColumnDefinition Width="38" />
                                                    <ColumnDefinition Width="36" />
                                                    <ColumnDefinition Width="52" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Text="{Binding Year}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           Grid.Column="0" />

                                                <TextBlock Text="{Binding Date}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           Margin="4,0,0,0"
                                                           Grid.Column="1" />

                                                <TextBlock Text="{Binding Day}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           HorizontalAlignment="Center"
                                                           Grid.Column="2" />

                                                <TextBlock Text="{Binding Time}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           HorizontalAlignment="Right"
                                                           Grid.Column="3" />

                                                <TextBlock Text="{Binding DesignerName}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="SemiBold"
                                                           Margin="16,0,0,0"
                                                           Grid.Column="4" />
                                            </Grid>
                                        </DataTemplate>
                                    </MenuItem.ItemTemplate>
                                </MenuItem>


                            </ContextMenu>
                        </Border.ContextMenu>

                        <Border.InputBindings>
                            <MouseBinding Gesture="LeftDoubleClick"
                                          Command="{Binding DataContext.OpenUpOrderInfoWindowCommand, 
                                                            RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                        </Border.InputBindings>
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="PreviewMouseLeftButtonDown">
                                <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, 
                                                             RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                       CommandParameter="{Binding .}" />
                            </i:EventTrigger>
                            <i:EventTrigger EventName="PreviewMouseRightButtonDown">
                                <i:InvokeCommandAction Command="{Binding DataContext.ItemRightClickedCommand, 
                                                             RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                       CommandParameter="{Binding .}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=headerIcon, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerCaseID, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerPrescription, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerShade, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerScanInfo, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerDesigner, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerCustomer, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerItems, Path=Width}" />
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal"
                                        Margin="0,2,0,2">
                                <Border BorderBrush="#F5F5F5"
                                        BorderThickness="1"
                                        x:Name="brdPanColor">

                                    <Rectangle Width="12"
                                               Height="auto"
                                               Margin="0,0,0,0"
                                               x:Name="rctPanColor">
                                        <Rectangle.Fill>
                                            <SolidColorBrush Color="{Binding PanColor}" />
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Border>

                                <Ellipse Width="28"
                                         Height="28"
                                         Margin="3,0,2,0"
                                         Grid.Column="0"
                                         VerticalAlignment="Top"
                                         x:Name="Icon">
                                    <Ellipse.Fill>
                                        <ImageBrush ImageSource="{Binding ImageSource}"
                                                    RenderOptions.BitmapScalingMode="Fant" />
                                    </Ellipse.Fill>
                                </Ellipse>
                            </StackPanel>



                            <!-- OrderID & Creation/Modification dates -->
                            <StackPanel VerticalAlignment="Top"
                                        Height="32"
                                        Grid.Column="1"
                                        Margin="4,0,10,0">
                                <StackPanel Orientation="Vertical"
                                            Margin="0,2,0,0">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding IntOrderID}"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center"
                                                   FontSize="12"
                                                   Foreground="Black"
                                                   TextTrimming="CharacterEllipsis" />
                                        <TextBlock d:Text="(tool tip text)"
                                                   x:Name="ToolTipText"
                                                   FontSize="9"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="5,0,0,0" />

                                    </StackPanel>


                                    <StackPanel Orientation="Horizontal"
                                                Margin="0,1,0,0">


                                        <Label Content="Created:"
                                               FontSize="8"
                                               Foreground="DarkGreen"
                                               FontWeight="Normal"
                                               Padding="0,0,4,0" />
                                        <TextBlock Text="{Binding MaxCreateDateFriendly}"
                                                   Foreground="#44474D"
                                                   FontSize="8"
                                                   VerticalAlignment="Center"
                                                   TextWrapping="WrapWithOverflow" />

                                        <Label Content="Modified:"
                                               FontSize="8"
                                               Foreground="SteelBlue"
                                               FontWeight="Normal"
                                               x:Name="lblModified"
                                               Padding="8,0,4,0"
                                               Visibility="{Binding ModificationDate, Converter={StaticResource EmptyToCollapsedConverter}}" />
                                        <TextBlock Text="{Binding ModificationDate}"
                                                   x:Name="tbModificationDate"
                                                   Foreground="#44474D"
                                                   FontSize="8"
                                                   FontWeight="Normal"
                                                   VerticalAlignment="Center"
                                                   Visibility="{Binding ModificationDate, Converter={StaticResource EmptyToCollapsedConverter}}"
                                                   TextWrapping="WrapWithOverflow" />

                                        <Label Content="Designed At:"
                                               FontSize="8"
                                               Foreground="DarkGoldenrod"
                                               FontWeight="Normal"
                                               Padding="8,0,4,0"
                                               Visibility="{Binding ExtOrderID, Converter={StaticResource EmptyToCollapsedConverter}}" />
                                        <TextBlock Text="{Binding Patient_RefNo, Converter={StaticResource CleanUpDesignedByStringConverter}}"
                                                   Foreground="#44474D"
                                                   FontSize="8"
                                                   FontWeight="Normal"
                                                   VerticalAlignment="Center"
                                                   Visibility="{Binding ExtOrderID, Converter={StaticResource EmptyToCollapsedConverter}}"
                                                   TextWrapping="WrapWithOverflow" />

                                    </StackPanel>

                                </StackPanel>
                            </StackPanel>


                            <!-- Prescription / Image icon -->
                            <StackPanel Grid.Column="2"
                                        VerticalAlignment="Center">
                                <Image Source="\Images\ListViewIcons\image.png"
                                       Width="21"
                                       Height="22"
                                       ToolTip="This order has images / rx form"
                                       Visibility="{Binding HasAnyImage, Converter={StaticResource BoolToVisibilityConverter}}" />
                            </StackPanel>

                            <!-- Shade -->
                            <Grid Grid.Column="3"
                                  VerticalAlignment="Center"
                                  HorizontalAlignment="Center">
                                <TextBlock Text="{Binding Shade}"
                                           Foreground="Black"
                                           FontWeight="SemiBold"
                                           VerticalAlignment="Center"
                                           FontSize="10"
                                           Margin="5,0,0,0"
                                           TextTrimming="CharacterEllipsis" />
                            </Grid>

                            <!-- Scanner Info & Other -->
                            <StackPanel Grid.Column="4"
                                        VerticalAlignment="Top">
                                <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,0">

                                    <Label Content="Scan source:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Margin="3,0,3,0"
                                           Padding="0"
                                           Visibility="{Binding ScanSourceFriendlyName, Converter={StaticResource EmptyToHiddenConverter}}" />

                                    <TextBlock Text="{Binding ScanSourceFriendlyName}"
                                               Foreground="#44474D"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbScanSource" />
                                </StackPanel>

                                <StackPanel Orientation="Horizontal"
                                            Margin="3,-1,0,0">
                                    <Label Content="Scan date:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Margin="7,0,3,0"
                                           Padding="0"
                                           Visibility="{Binding CacheMaxScanDateFriendly, Converter={StaticResource EmptyToHiddenConverter}}" />
                                    <TextBlock Text="{Binding CacheMaxScanDateFriendly}"
                                               Foreground="#44474D"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbCacheMaxScanDate" />
                                </StackPanel>

                                <StackPanel Orientation="Horizontal"
                                            Margin="0,-1,0,00">
                                    <Label Content="Last touched:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Margin="0,0,3,0"
                                           Padding="0"
                                           Visibility="{Binding LastModifiedComputerName, Converter={StaticResource EmptyToHiddenConverter}}" />
                                    <TextBlock Text="{Binding LastModifiedComputerName}"
                                               x:Name="tbLastTouchedBy"
                                               Foreground="#300300"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               TextTrimming="CharacterEllipsis" />
                                </StackPanel>



                            </StackPanel>


                            <!-- Designer -->
                            <StackPanel Grid.Column="5"
                                        VerticalAlignment="Top">
                                <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,0">

                                    <TextBlock Text="{Binding ExtOrderID}"
                                               Foreground="#AE0270"
                                               FontSize="12"
                                               FontWeight="DemiBold"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow" />
                                </StackPanel>
                            </StackPanel>

                            <!-- Customer & Patient info -->
                            <StackPanel Orientation="Vertical"
                                        Grid.Column="6"
                                        Margin="5,0,10,0"
                                        VerticalAlignment="Top">
                                <TextBlock Text="{Binding Customer}"
                                           Foreground="Black"
                                           FontWeight="SemiBold"
                                           TextWrapping="WrapWithOverflow"
                                           Margin="0,0,0,0"
                                           Padding="0"
                                           VerticalAlignment="Top" />


                                <StackPanel Orientation="Horizontal"
                                            Margin="0,-2,0,0"
                                            VerticalAlignment="Bottom">

                                    <TextBlock Text="{Binding Patient_FirstName}"
                                               Foreground="#666"
                                               FontSize="11"
                                               VerticalAlignment="Center"
                                               FontWeight="SemiBold"
                                               Margin="0,1,0,0"
                                               TextWrapping="WrapWithOverflow" />

                                    <TextBlock Text="{Binding Patient_LastName}"
                                               Foreground="#777"
                                               FontSize="11"
                                               Margin="5,1,0,0"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow" />



                                </StackPanel>
                            </StackPanel>






                            <!-- Items & Manufacturers -->
                            <StackPanel Grid.Column="7"
                                        VerticalAlignment="Top"
                                        Margin="5,0,0,0">
                                <TextBlock Text="{Binding Items}"
                                           Foreground="Black"
                                           VerticalAlignment="Top"
                                           Margin="0,0,0,0"
                                           Padding="0"
                                           TextTrimming="CharacterEllipsis" />
                                <StackPanel Orientation="Horizontal"
                                            Margin="0,2,0,0">
                                    <TextBlock Text="{Binding CacheMaterialName}"
                                               Foreground="#3f793f"
                                               FontSize="9"
                                               TextTrimming="CharacterEllipsis"
                                               x:Name="tbCacheMaterialName" />
                                    <TextBlock Text="{Binding ManufName}"
                                               Foreground="#8d8d3d"
                                               FontSize="9"
                                               Margin="5,0,0,0"
                                               TextTrimming="CharacterEllipsis"
                                               x:Name="tbManufName" />
                                </StackPanel>


                            </StackPanel>


                        </Grid>
                    </Border>


                    <ControlTemplate.Triggers>
                        <Trigger Property="ItemsControl.AlternationIndex"
                                 Value="1">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#f7fefe" />
                        </Trigger>


                        <DataTrigger Binding="{Binding PreviouslyDesigned}"
                                     Value="True">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#dff2f7" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Previously designed!" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Blue" />
                            <Setter TargetName="brdPanColor"
                                    Property="BorderBrush"
                                    Value="Transparent" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding PanColor}"
                                     Value="Transparent">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#edfff6" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Pan is not registered!" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Green" />
                            <Setter TargetName="brdPanColor"
                                    Property="BorderBrush"
                                    Value="Transparent" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding PanNumber}"
                                     Value="">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#ffffe9" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="There is no pan number set!" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Orange" />
                            <Setter TargetName="brdPanColor"
                                    Property="BorderBrush"
                                    Value="Transparent" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding AlternateColoring}"
                                     Value="encode">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#ffedff" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Possible encode case" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Red" />
                            <Setter TargetName="tbManufName"
                                    Property="Foreground"
                                    Value="Red" />
                            <Setter TargetName="tbCacheMaterialName"
                                    Property="Foreground"
                                    Value="Maroon" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding AlternateColoring}"
                                     Value="noshade">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#fffccc" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Could not determine the shade" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Red" />
                        </DataTrigger>

                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter Property="BorderBrush"
                                    Value="#79bbf2"
                                    TargetName="Item" />
                            <Setter Property="BorderThickness"
                                    Value="1"
                                    TargetName="Item" />
                            <Setter Property="Background"
                                    Value="#d4e9fb"
                                    TargetName="Item" />
                            <Setter Property="Cursor"
                                    Value="Hand"
                                    TargetName="Item" />
                        </Trigger>



                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <Style TargetType="ListViewItem"
           x:Key="LvItemDetailedNewStyle">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1"
                            Margin="0,1,0,3"
                            CornerRadius="2"
                            BorderBrush="{Binding PanColor}"
                            Background="{Binding PanColor}"
                            Tag="{Binding IntOrderID}">

                        <!--Border.ContextMenu>
                            <ContextMenu Opened="ContextMenu_Opened"
                                         Closed="ContextMenu_Closed">
                                <MenuItem Header="{Binding IntOrderID}"
                                          IsEnabled="False">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/id.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator />

                                <MenuItem Header="View order"
                                          Click="MenuItemOpenUpOrderInfoWindow_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/open.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator />

                                <MenuItem Header="Rename"
                                          Visibility="{Binding CanBeRenamed, Converter={StaticResource BoolToVisibilityConverter}}"
                                          Click="MenuItemOpenUpRenameOrderWindow_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/rename.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <MenuItem Header="Generate StCopy"
                                          Visibility="{Binding CanGenerateStCopy, Converter={StaticResource BoolToVisibilityConverter}}"
                                          Click="MenuItemGenerateStCopy_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/stcopy.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <MenuItem Header="Set shade to"
                                          Visibility="{Binding Shade, Converter={StaticResource EmptyTextToVisibleConverter}}">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/update.png" />
                                    </MenuItem.Icon>
                                    <MenuItem Header="VITA">
                                        <MenuItem Header="A1"
                                                  Click="Shade_A1_Click" />
                                        <MenuItem Header="A2"
                                                  Click="Shade_A2_Click" />
                                        <MenuItem Header="A3"
                                                  Click="Shade_A3_Click" />
                                        <MenuItem Header="A3.5"
                                                  Click="Shade_A35_Click" />
                                        <MenuItem Header="A4"
                                                  Click="Shade_A4_Click" />
                                        <Separator />
                                        <MenuItem Header="B1"
                                                  Click="Shade_B1_Click" />
                                        <MenuItem Header="B2"
                                                  Click="Shade_B2_Click" />
                                        <MenuItem Header="B3"
                                                  Click="Shade_B3_Click" />
                                        <MenuItem Header="B4"
                                                  Click="Shade_B4_Click" />
                                        <Separator />
                                        <MenuItem Header="C1"
                                                  Click="Shade_C1_Click" />
                                        <MenuItem Header="C2"
                                                  Click="Shade_C2_Click" />
                                        <MenuItem Header="C3"
                                                  Click="Shade_C3_Click" />
                                        <MenuItem Header="C4"
                                                  Click="Shade_C4_Click" />
                                        <Separator />
                                        <MenuItem Header="D2"
                                                  Click="Shade_D2_Click" />
                                        <MenuItem Header="D3"
                                                  Click="Shade_D3_Click" />
                                        <MenuItem Header="D4"
                                                  Click="Shade_D4_Click" />
                                    </MenuItem>
                                    <MenuItem Header="VITA 3D">
                                        <MenuItem Header="1M1"
                                                  Click="Shade_1M1_Click" />
                                        <MenuItem Header="1M2"
                                                  Click="Shade_1M2_Click" />
                                        <Separator />
                                        <MenuItem Header="2M1"
                                                  Click="Shade_2M1_Click" />
                                        <MenuItem Header="2M2"
                                                  Click="Shade_2M2_Click" />
                                        <MenuItem Header="2M3"
                                                  Click="Shade_2M3_Click" />
                                        <Separator />
                                        <MenuItem Header="3M1"
                                                  Click="Shade_3M1_Click" />
                                        <MenuItem Header="3M2"
                                                  Click="Shade_3M2_Click" />
                                        <MenuItem Header="3M3"
                                                  Click="Shade_3M3_Click" />
                                        <Separator />
                                        <MenuItem Header="4M1"
                                                  Click="Shade_4M1_Click" />
                                        <MenuItem Header="4M2"
                                                  Click="Shade_4M2_Click" />
                                        <MenuItem Header="4M3"
                                                  Click="Shade_4M3_Click" />
                                        <Separator />
                                        <MenuItem Header="5M1"
                                                  Click="Shade_5M1_Click" />
                                        <MenuItem Header="5M2"
                                                  Click="Shade_5M2_Click" />
                                        <MenuItem Header="5M3"
                                                  Click="Shade_5M3_Click" />
                                        <Separator />
                                        <MenuItem Header="2L1.5"
                                                  Click="Shade_2L15_Click" />
                                        <MenuItem Header="2L2.5"
                                                  Click="Shade_2L25_Click" />
                                        <MenuItem Header="3L1.5"
                                                  Click="Shade_3L15_Click" />
                                        <MenuItem Header="3L2.5"
                                                  Click="Shade_3L25_Click" />
                                        <MenuItem Header="4L1.5"
                                                  Click="Shade_4L15_Click" />
                                        <MenuItem Header="4L2.5"
                                                  Click="Shade_4L25_Click" />
                                        <Separator />
                                        <MenuItem Header="2R1.5"
                                                  Click="Shade_2R15_Click" />
                                        <MenuItem Header="2R2.5"
                                                  Click="Shade_2R25_Click" />
                                        <MenuItem Header="3R1.5"
                                                  Click="Shade_3R15_Click" />
                                        <MenuItem Header="3R2.5"
                                                  Click="Shade_3R25_Click" />
                                        <MenuItem Header="4R1.5"
                                                  Click="Shade_4R15_Click" />
                                        <MenuItem Header="4R2.5"
                                                  Click="Shade_4R25_Click" />
                                    </MenuItem>
                                    <MenuItem Header="Bleach / White">
                                        <MenuItem Header="0M1"
                                                  Click="Shade_0M1_Click" />
                                        <MenuItem Header="0M2"
                                                  Click="Shade_0M2_Click" />
                                        <MenuItem Header="0M3"
                                                  Click="Shade_0M3_Click" />
                                        <MenuItem Header="0M4"
                                                  Click="Shade_0M4_Click" />
                                        <Separator />
                                        <MenuItem Header="BL1"
                                                  Click="Shade_BL1_Click" />
                                        <MenuItem Header="BL2"
                                                  Click="Shade_BL2_Click" />
                                        <MenuItem Header="BL3"
                                                  Click="Shade_BL3_Click" />
                                        <MenuItem Header="BL4"
                                                  Click="Shade_BL4_Click" />
                                        <Separator />
                                        <MenuItem Header="010"
                                                  Click="Shade_010_Click" />
                                        <MenuItem Header="020"
                                                  Click="Shade_020_Click" />
                                        <MenuItem Header="030"
                                                  Click="Shade_030_Click" />
                                        <MenuItem Header="040"
                                                  Click="Shade_040_Click" />
                                    </MenuItem>

                                </MenuItem>

                                <MenuItem Header="Explore order folder"
                                          Click="MenuItemExploreFolder_Click">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ToolBar/folder.png" />
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator Visibility="{Binding HasDesignerHistory, Converter={StaticResource BoolToVisibilityConverter}}" />

                                <MenuItem Header="Designer History"
                                          ItemsSource="{Binding DesignerHistory}"
                                          Visibility="{Binding HasDesignerHistory, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <MenuItem.Icon>
                                        <Image  Source="/Images/ListViewIcons/psModelled.png" />
                                    </MenuItem.Icon>
                                    <MenuItem.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="32" />
                                                    <ColumnDefinition Width="38" />
                                                    <ColumnDefinition Width="36" />
                                                    <ColumnDefinition Width="52" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Text="{Binding Year}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           Grid.Column="0" />

                                                <TextBlock Text="{Binding Date}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           Margin="4,0,0,0"
                                                           Grid.Column="1" />

                                                <TextBlock Text="{Binding Day}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           HorizontalAlignment="Center"
                                                           Grid.Column="2" />

                                                <TextBlock Text="{Binding Time}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="Normal"
                                                           HorizontalAlignment="Right"
                                                           Grid.Column="3" />

                                                <TextBlock Text="{Binding DesignerName}"
                                                           FontFamily="pack://application:,,,/Fonts/#RobotoMono"
                                                           FontWeight="SemiBold"
                                                           Margin="16,0,0,0"
                                                           Grid.Column="4" />
                                            </Grid>
                                        </DataTemplate>
                                    </MenuItem.ItemTemplate>
                                </MenuItem>


                            </ContextMenu>
                        </Border.ContextMenu-->

                        <Border.InputBindings>
                            <MouseBinding Gesture="LeftDoubleClick"
                                          Command="{Binding DataContext.OpenUpOrderInfoWindowCommand, 
                                                            RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                        </Border.InputBindings>
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="PreviewMouseDown">
                                <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, 
                                                             RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                       CommandParameter="{Binding .}" />
                            </i:EventTrigger>
                            <!--i:EventTrigger EventName="PreviewMouseRightButtonDown">
                                <i:InvokeCommandAction Command="{Binding DataContext.ItemRightClickedCommand, 
                                                             RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                       CommandParameter="{Binding .}" />
                            </i:EventTrigger-->
                        </i:Interaction.Triggers>
                        <Grid Background="#EFFFFFFF">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=headerIcon, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerCaseID, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerButtons, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerShade, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerScanInfo, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerDesigner, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerCustomer, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerItems, Path=Width}" />
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal"
                                        Margin="0,0,0,0">
                                <Grid>
                                    <Image Source="\Images\ListViewIcons\image2.png"
                                           Width="12"
                                           Height="12"
                                           Margin="0,3,4,0"
                                           ToolTip="This order has images / rx form"
                                           Panel.ZIndex="1"
                                           VerticalAlignment="Top"
                                           HorizontalAlignment="Left"
                                           Visibility="{Binding HasAnyImage, Converter={StaticResource BoolToVisibilityConverter}}" />
                                    <Border BorderBrush="#F5F5F5"
                                            BorderThickness="1"
                                            x:Name="brdPanColor">

                                        <Grid>
                                            <Rectangle Width="14"
                                                       Height="auto"
                                                       Margin="-2,-2,0,-2"
                                                       HorizontalAlignment="Left"
                                                       x:Name="rctPanColor">
                                                <Rectangle.Fill>
                                                    <SolidColorBrush Color="{Binding PanColor}" />
                                                </Rectangle.Fill>
                                            </Rectangle>


                                            <d:TextBlock Text="{Binding PanNumber}"
                                                         FontSize="22"
                                                         Padding="5,0,0,0"
                                                         Margin="15,1,0,0"
                                                         MinWidth="63"
                                                         MaxWidth="63"
                                                         TextTrimming="WordEllipsis"
                                                         Foreground="{Binding PanColor}"
                                                         VerticalAlignment="Top"
                                                         HorizontalAlignment="Left" />

                                            <core:OutlinedTextBlock Stroke="#888"
                                                                    StrokePosition="Outside"
                                                                    FontSize="22"
                                                                    MinWidth="63"
                                                                    MaxWidth="63"
                                                                    FontWeight="SemiBold"
                                                                    Fill="{Binding PanColor}"
                                                                    StrokeThickness="0.35"
                                                                    Text="{Binding PanNumber}"
                                                                    VerticalAlignment="Top"
                                                                    HorizontalAlignment="Left"
                                                                    TextTrimming="WordEllipsis"
                                                                    Margin="17,1,0,0" />

                                        </Grid>
                                    </Border>
                                </Grid>

                                <Ellipse Width="33"
                                         Height="33"
                                         Margin="3,0,2,0"
                                         Grid.Column="0"
                                         VerticalAlignment="Top"
                                         x:Name="Icon">
                                    <Ellipse.Fill>
                                        <ImageBrush ImageSource="{Binding ImageSource}"
                                                    RenderOptions.BitmapScalingMode="Fant" />
                                    </Ellipse.Fill>
                                </Ellipse>
                            </StackPanel>



                            <!-- OrderID & Creation/Modification dates -->
                            <StackPanel VerticalAlignment="Top"
                                        Height="32"
                                        Grid.Column="1"
                                        Margin="4,0,10,0">
                                <StackPanel Orientation="Vertical"
                                            Margin="0,2,0,0">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding IntOrderID}"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center"
                                                   FontSize="12"
                                                   Foreground="Black"
                                                   TextTrimming="CharacterEllipsis" />
                                        <TextBlock d:Text="(tool tip text)"
                                                   x:Name="ToolTipText"
                                                   FontSize="9"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="5,0,0,0" />

                                    </StackPanel>


                                    <StackPanel Orientation="Horizontal"
                                                Margin="0,1,0,0">


                                        <Label Content="Created:"
                                               FontSize="8"
                                               Foreground="DarkGreen"
                                               FontWeight="Normal"
                                               Padding="0,0,4,0" />
                                        <TextBlock Text="{Binding MaxCreateDateFriendly}"
                                                   Foreground="#44474D"
                                                   FontSize="8"
                                                   VerticalAlignment="Center"
                                                   TextWrapping="WrapWithOverflow" />

                                        <Label Content="Modified:"
                                               FontSize="8"
                                               Foreground="SteelBlue"
                                               FontWeight="Normal"
                                               x:Name="lblModified"
                                               Padding="8,0,4,0"
                                               Visibility="{Binding ModificationDate, Converter={StaticResource EmptyToCollapsedConverter}}" />
                                        <TextBlock Text="{Binding ModificationDate}"
                                                   x:Name="tbModificationDate"
                                                   Foreground="#44474D"
                                                   FontSize="8"
                                                   FontWeight="Normal"
                                                   VerticalAlignment="Center"
                                                   Visibility="{Binding ModificationDate, Converter={StaticResource EmptyToCollapsedConverter}}"
                                                   TextWrapping="WrapWithOverflow" />

                                        <Label Content="Designed At:"
                                               FontSize="8"
                                               Foreground="DarkGoldenrod"
                                               FontWeight="Normal"
                                               Padding="8,0,4,0"
                                               Visibility="{Binding ExtOrderID, Converter={StaticResource EmptyToCollapsedConverter}}" />
                                        <TextBlock Text="{Binding Patient_RefNo, Converter={StaticResource CleanUpDesignedByStringConverter}}"
                                                   Foreground="#44474D"
                                                   FontSize="8"
                                                   FontWeight="Normal"
                                                   VerticalAlignment="Center"
                                                   Visibility="{Binding ExtOrderID, Converter={StaticResource EmptyToCollapsedConverter}}"
                                                   TextWrapping="WrapWithOverflow" />

                                    </StackPanel>

                                </StackPanel>
                            </StackPanel>


                            <!-- Buttons -->
                            <StackPanel Grid.Column="2"
                                        VerticalAlignment="Top"
                                        d:Visibility="Visible"
                                        Visibility="Hidden"
                                        x:Name="tsButtonPanel">
                                <Grid HorizontalAlignment="Right">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />

                                    </Grid.ColumnDefinitions>
                                    <Button Width="28"
                                            Height="24"
                                            Background="#55FFFFFF"
                                            Margin="0,0,4,0"
                                            Grid.Column="0"
                                            ToolTip="Rename"
                                            Style="{StaticResource ThreeShapeListviewButton}"
                                            Visibility="{Binding CanBeRenamed, Converter={StaticResource BoolToVisibilityConverter}}"
                                            Click="MenuItemOpenUpRenameOrderWindow_Click"
                                            d:Visibility="Visible">
                                        <Image Source="\Images\ToolBar\rename.png"
                                               Width="23"
                                               Height="23" />
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="PreviewMouseDown">
                                                <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                       CommandParameter="{Binding .}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </Button>

                                    <Button Width="28"
                                            Height="24"
                                            Background="#55FFFFFF"
                                            Margin="0,0,4,0"
                                            ToolTip="Generate StCopy"
                                            Grid.Column="1"
                                            Style="{StaticResource ThreeShapeListviewButton}"
                                            Visibility="{Binding CanGenerateStCopy, Converter={StaticResource BoolToVisibilityConverter}}"
                                            Click="MenuItemGenerateStCopy_Click"
                                            d:Visibility="Visible">
                                        <Image Source="\Images\ToolBar\stcopy.png"
                                               Width="25"
                                               Height="25" />
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="PreviewMouseDown">
                                                <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                       CommandParameter="{Binding .}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </Button>
                                    <Button Width="28"
                                            Height="28"
                                            Background="#55FFFFFF"
                                            Margin="0,0,4,0"
                                            Grid.Column="2"
                                            ToolTip="Open Details"
                                            Style="{StaticResource ThreeShapeListviewButton}"
                                            Click="MenuItemOpenUpOrderInfoWindow_Click"
                                            d:Visibility="Visible">
                                        <Image Source="\Images\ToolBar\info2.png"
                                               Width="31"
                                               Height="31" />
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="PreviewMouseDown">
                                                <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                       CommandParameter="{Binding .}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </Button>
                                    <Button Width="28"
                                            Height="28"
                                            Background="#55FFFFFF"
                                            Margin="0,0,4,0"
                                            Grid.Column="3"
                                            ToolTip="Explore folder"
                                            Style="{StaticResource ThreeShapeListviewButton}"
                                            Click="MenuItemExploreFolder_Click"
                                            d:Visibility="Visible">


                                        <Image Source="\Images\ToolBar\folder.png"
                                               Width="31"
                                               Height="31" />
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="PreviewMouseDown">
                                                <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                       CommandParameter="{Binding .}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>


                                    </Button>
                                    <Button Width="28"
                                            Height="24"
                                            Background="#55FFFFFF"
                                            Margin="0,0,4,0"
                                            Grid.Column="4"
                                            ToolTip="Lookup case"
                                            Style="{StaticResource ThreeShapeListviewButton}"
                                            Click="MenuItemLabnext_Click"
                                            Visibility="{Binding DataContext.CbSettingModuleLabnext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}, Converter={StaticResource BoolToVisibilityConverter}}"
                                            d:Visibility="Visible">


                                        <Image Source="\Images\ToolBar\labnext.png"
                                               Width="31"
                                               Height="31" />
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="PreviewMouseUp">
                                                <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                       CommandParameter="{Binding .}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>


                                    </Button>
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="PreviewMouseDown">
                                            <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                   CommandParameter="{Binding .}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </Grid>
                            </StackPanel>



                            <!-- Shade -->
                            <Grid Grid.Column="3"
                                  VerticalAlignment="Top"
                                  HorizontalAlignment="Center">
                                <TextBlock Text="{Binding Shade}"
                                           Foreground="Black"
                                           FontWeight="SemiBold"
                                           VerticalAlignment="Center"
                                           FontSize="10"
                                           Margin="5,8,0,0"
                                           TextTrimming="CharacterEllipsis" />
                            </Grid>

                            <!-- Scanner Info & Other -->
                            <StackPanel Grid.Column="4"
                                        VerticalAlignment="Top">
                                <!--tackPanel Orientation="Horizontal"
                                            Margin="0,0,0,0">

                                    <Label Content="Scan source:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Margin="3,0,3,0"
                                           Padding="0"
                                           Visibility="{Binding ScanSourceFriendlyName, Converter={StaticResource EmptyToHiddenConverter}}" />

                                    <TextBlock Text="{Binding ScanSourceFriendlyName}"
                                               Foreground="#44474D"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbScanSource" />
                                </StackPanel>

                                <StackPanel Orientation="Horizontal"
                                            Margin="3,-1,0,0">
                                    <Label Content="Scan date:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Margin="7,0,3,0"
                                           Padding="0"
                                           Visibility="{Binding CacheMaxScanDateFriendly, Converter={StaticResource EmptyToHiddenConverter}}" />
                                    <TextBlock Text="{Binding CacheMaxScanDateFriendly}"
                                               Foreground="#44474D"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbCacheMaxScanDate" />
                                </StackPanel-->

                                <StackPanel Orientation="Vertical"
                                            Margin="4,0,0,0">

                                    <TextBlock Text="{Binding LastModifiedComputerName}"
                                               x:Name="tbLastTouchedBy"
                                               Foreground="#027575"
                                               FontSize="12"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Left"
                                               TextTrimming="CharacterEllipsis" />
                                    <TextBlock Text="{Binding ModificationDate}"
                                               Foreground="#034400"
                                               FontSize="9"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Left"
                                               TextTrimming="CharacterEllipsis" />
                                </StackPanel>



                            </StackPanel>


                            <!-- Designer -->
                            <StackPanel Grid.Column="5"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Center">
                                <StackPanel Orientation="Horizontal"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            Margin="0,0,0,0">

                                    <TextBlock Text="{Binding ExtOrderID}"
                                               Foreground="#AE0270"
                                               FontSize="12"
                                               FontWeight="DemiBold"
                                               VerticalAlignment="Center"
                                               Width="135"
                                               TextWrapping="WrapWithOverflow" />
                                </StackPanel>
                            </StackPanel>

                            <!-- Customer & Patient info -->
                            <StackPanel Orientation="Vertical"
                                        Grid.Column="6"
                                        Margin="5,0,10,0"
                                        VerticalAlignment="Top">
                                <TextBlock Text="{Binding Customer}"
                                           Foreground="Black"
                                           FontWeight="SemiBold"
                                           TextWrapping="WrapWithOverflow"
                                           Margin="0,0,0,0"
                                           Padding="0"
                                           VerticalAlignment="Top" />


                                <StackPanel Orientation="Horizontal"
                                            Margin="0,-2,0,0"
                                            VerticalAlignment="Bottom">

                                    <TextBlock Text="{Binding Patient_FirstName}"
                                               Foreground="#666"
                                               FontSize="11"
                                               VerticalAlignment="Center"
                                               FontWeight="SemiBold"
                                               Margin="0,1,0,0"
                                               TextWrapping="WrapWithOverflow" />

                                    <TextBlock Text="{Binding Patient_LastName}"
                                               Foreground="#777"
                                               FontSize="11"
                                               Margin="5,1,0,0"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow" />



                                </StackPanel>
                            </StackPanel>






                            <!-- Items & Manufacturers -->
                            <StackPanel Grid.Column="7"
                                        VerticalAlignment="Top"
                                        Margin="5,0,0,0">
                                <TextBlock Text="{Binding Items}"
                                           Foreground="Black"
                                           VerticalAlignment="Top"
                                           Margin="0,0,0,0"
                                           Padding="0"
                                           TextTrimming="CharacterEllipsis" />
                                <StackPanel Orientation="Horizontal"
                                            Margin="0,2,0,0">
                                    <TextBlock Text="{Binding CacheMaterialName}"
                                               Foreground="#3f793f"
                                               FontSize="9"
                                               TextTrimming="CharacterEllipsis"
                                               x:Name="tbCacheMaterialName" />
                                    <TextBlock Text="{Binding ManufName}"
                                               Foreground="#8d8d3d"
                                               FontSize="9"
                                               Margin="5,0,0,0"
                                               TextTrimming="CharacterEllipsis"
                                               x:Name="tbManufName" />
                                </StackPanel>


                            </StackPanel>


                        </Grid>
                    </Border>


                    <ControlTemplate.Triggers>
                        <Trigger Property="ItemsControl.AlternationIndex"
                                 Value="1">
                            <!--Setter TargetName="Item"
                                    Property="Background"
                                    Value="#f7fefe" /-->
                        </Trigger>


                        <DataTrigger Binding="{Binding PreviouslyDesigned}"
                                     Value="True">
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Previously designed!" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Blue" />
                            <Setter TargetName="brdPanColor"
                                    Property="BorderBrush"
                                    Value="Transparent" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding PanColor}"
                                     Value="Transparent">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#B3AE9B" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Pan is not registered!" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Green" />
                            <Setter TargetName="brdPanColor"
                                    Property="BorderBrush"
                                    Value="Transparent" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding PanNumber}"
                                     Value="">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#B3AE9B" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="There is no pan number set!" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Orange" />
                            <Setter TargetName="brdPanColor"
                                    Property="BorderBrush"
                                    Value="Transparent" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding AlternateColoring}"
                                     Value="encode">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#B3AE9B" />
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Possible encode case" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Red" />
                            <Setter TargetName="tbManufName"
                                    Property="Foreground"
                                    Value="Red" />
                            <Setter TargetName="tbCacheMaterialName"
                                    Property="Foreground"
                                    Value="Maroon" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding AlternateColoring}"
                                     Value="noshade">
                            <Setter TargetName="ToolTipText"
                                    Property="Text"
                                    Value="Could not determine the shade" />
                            <Setter TargetName="ToolTipText"
                                    Property="Foreground"
                                    Value="Red" />
                        </DataTrigger>

                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter Property="BorderBrush"
                                    Value="#e0b000"
                                    TargetName="Item" />
                            <Setter Property="BorderThickness"
                                    Value="1,2,1,2"
                                    TargetName="Item" />
                            <Setter Property="Margin"
                                    Value="0,0,0,2"
                                    TargetName="Item" />
                            <!--Setter Property="Background"
                                    Value="#d4e9fb"
                                    TargetName="Item" /-->
                            <Setter Property="Cursor"
                                    Value="Hand"
                                    TargetName="Item" />
                            <Setter Property="Visibility"
                                    Value="Visible"
                                    TargetName="tsButtonPanel" />
                        </Trigger>



                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvItemIssues -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemIssues">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="IssueItem"
                            BorderThickness="1"
                            Height="26"
                            Background="{Binding Color}"
                            Tag="{Binding OrderID}">
                        <Border.InputBindings>
                            <MouseBinding Gesture="LeftDoubleClick"
                                          Command="{Binding DataContext.SearchForOrderByOrderIssueClickCommand,
                                                            RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                        </Border.InputBindings>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=lvIssuesOrderID, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=lvIssuesSkipReason, Path=Width}" />
                            </Grid.ColumnDefinitions>


                            <TextBlock Text="{Binding OrderID}"
                                       Grid.Column="0"
                                       FontWeight="SemiBold"
                                       VerticalAlignment="Center"
                                       FontSize="13"
                                       Foreground="Black"
                                       Margin="5,0,20,0"
                                       TextTrimming="CharacterEllipsis" />


                            <TextBlock Text="{Binding IssueDescription}"
                                       Grid.Column="1"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       FontSize="13"
                                       Foreground="Black"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />

                        </Grid>

                    </Border>


                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter Property="BorderBrush"
                                    Value="#79bbf2"
                                    TargetName="IssueItem" />
                            <Setter Property="Background"
                                    Value="#a3b502"
                                    TargetName="IssueItem" />
                            <Setter Property="Cursor"
                                    Value="Hand"
                                    TargetName="IssueItem" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- LvItemDebug -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemDebug">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="IssueItem"
                            BorderThickness="1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=lvDebugLocation, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=lvDebugLineNumber, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=lvDebugTime, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=lvDebugMessage, Path=Width}" />
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="{Binding DLocation}"
                                       Grid.Column="0"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />

                            <TextBlock Text="{Binding DLineNumber}"
                                       Grid.Column="1"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />


                            <TextBlock Text="{Binding DTime}"
                                       Grid.Column="2"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextTrimming="CharacterEllipsis" />


                            <TextBlock Text="{Binding DMessage}"
                                       Grid.Column="3"
                                       FontWeight="Normal"
                                       VerticalAlignment="Center"
                                       FontSize="12"
                                       Margin="5,0,0,0"
                                       TextWrapping="Wrap" />



                        </Grid>

                    </Border>

                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvItemPanColors -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemPanColors">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="IssueItem"
                            BorderThickness="1"
                            Margin="2,2,12,2"
                            Background="{Binding Color}">
                        <Grid>
                            <TextBlock Text="{Binding FriendlyName}"
                                       Grid.Column="0"
                                       FontWeight="Thin"
                                       VerticalAlignment="Center"
                                       FontSize="14"
                                       Margin="5,0,0,0"
                                       Padding="5"
                                       Cursor="Hand"
                                       Foreground="{Binding IsItDarkColor, Converter={StaticResource DarkColorBoolToColorConverter}}"
                                       TextTrimming="CharacterEllipsis">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="MouseDown">
                                        <i:InvokeCommandAction Command="{Binding DataContext.ItemClickedCommand, 
                                             RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                               CommandParameter="{Binding .}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </TextBlock>

                        </Grid>

                    </Border>

                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvItemForItemList-->
    <Style TargetType="ListViewItem"
           x:Key="LvItemForItemList">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=headerItem, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerCacheMaterialName, Path=Width}" />
                            </Grid.ColumnDefinitions>



                            <!-- Item -->
                            <StackPanel VerticalAlignment="Top"
                                        Height="auto"
                                        MinHeight="25"
                                        Grid.Column="0"
                                        Margin="0,0,10,0">
                                <StackPanel Orientation="Vertical"
                                            Margin="0,0,0,0">
                                    <TextBlock Text="{Binding Item}"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"
                                               FontSize="12"
                                               Foreground="{Binding StCopyExists}"
                                               TextTrimming="CharacterEllipsis"
                                               HorizontalAlignment="Right"
                                               x:Name="tbItem" />


                                    <StackPanel Orientation="Horizontal"
                                                Margin="0,1,0,0"
                                                HorizontalAlignment="Right">


                                        <Label Content="Manufacturer set:"
                                               FontSize="8"
                                               FontWeight="Normal"
                                               Padding="0,0,4,0"
                                               x:Name="lblManufActual">
                                            <Label.Visibility>
                                                <MultiBinding StringFormat=" {0}, {1}"
                                                              Converter="{StaticResource EqualToHiddenConverter}">
                                                    <Binding ElementName="tbManufOriginal"
                                                             Path="Text" />
                                                    <Binding ElementName="tbManufActual"
                                                             Path="Text" />
                                                </MultiBinding>
                                            </Label.Visibility>
                                        </Label>
                                        <TextBlock Text="{Binding ManufName}"
                                                   x:Name="tbManufActual"
                                                   Foreground="Crimson"
                                                   FontSize="8"
                                                   VerticalAlignment="Center"
                                                   TextWrapping="WrapWithOverflow"
                                                   Padding="0,0,0,1">
                                            <TextBlock.Visibility>
                                                <MultiBinding StringFormat=" {0}, {1}"
                                                              Converter="{StaticResource EqualToHiddenConverter}">
                                                    <Binding ElementName="tbManufOriginal"
                                                             Path="Text" />
                                                    <Binding ElementName="tbManufActual"
                                                             Path="Text" />
                                                </MultiBinding>
                                            </TextBlock.Visibility>
                                        </TextBlock>

                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal"
                                                Margin="0,1,0,2"
                                                HorizontalAlignment="Right">

                                        <Label Content="Original setup was:"
                                               FontSize="8"
                                               FontWeight="Normal"
                                               x:Name="lblManufOrig"
                                               Padding="8,0,4,0">
                                            <Label.Visibility>
                                                <MultiBinding StringFormat=" {0}, {1}"
                                                              Converter="{StaticResource EqualToHiddenConverter}">
                                                    <Binding ElementName="tbManufOriginal"
                                                             Path="Text" />
                                                    <Binding ElementName="tbManufActual"
                                                             Path="Text" />
                                                </MultiBinding>
                                            </Label.Visibility>
                                        </Label>
                                        <TextBlock Text="{Binding ManufName_stCopy}"
                                                   x:Name="tbManufOriginal"
                                                   Foreground="DarkGreen"
                                                   FontSize="8"
                                                   FontWeight="Normal"
                                                   VerticalAlignment="Center"
                                                   TextWrapping="WrapWithOverflow">
                                            <TextBlock.Visibility>
                                                <MultiBinding StringFormat=" {0}, {1}"
                                                              Converter="{StaticResource EqualToHiddenConverter}">
                                                    <Binding ElementName="tbManufOriginal"
                                                             Path="Text" />
                                                    <Binding ElementName="tbManufActual"
                                                             Path="Text" />
                                                </MultiBinding>
                                            </TextBlock.Visibility>
                                        </TextBlock>

                                    </StackPanel>

                                </StackPanel>
                            </StackPanel>


                            <!-- Material & manufProc -->

                            <StackPanel Orientation="Vertical"
                                        Grid.Column="1"
                                        Margin="5,0,10,0"
                                        VerticalAlignment="Top">
                                <TextBlock Text="{Binding CacheMaterialName}"
                                           Foreground="Black"
                                           FontWeight="SemiBold"
                                           TextWrapping="WrapWithOverflow"
                                           Margin="0,0,0,0"
                                           Padding="0"
                                           VerticalAlignment="Top" />


                                <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,2"
                                            VerticalAlignment="Bottom">
                                    <Label Content="ManufProc:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Foreground="#666666"
                                           Margin="0,1,3,0"
                                           Padding="0"
                                           x:Name="lblManufProc">
                                        <Label.Visibility>
                                            <MultiBinding StringFormat=" {0}, {1}"
                                                          Converter="{StaticResource EqualToHiddenConverter}">
                                                <Binding ElementName="tbManufacturingProcessIDOriginal"
                                                         Path="Text" />
                                                <Binding ElementName="tbManufacturingProcessIDActual"
                                                         Path="Text" />
                                            </MultiBinding>
                                        </Label.Visibility>
                                    </Label>
                                    <TextBlock Text="{Binding ManufacturingProcessID}"
                                               Foreground="Red"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               FontWeight="SemiBold"
                                               Margin="0,1,0,0"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbManufacturingProcessIDActual">
                                        <TextBlock.Visibility>
                                            <MultiBinding StringFormat=" {0}, {1}"
                                                          Converter="{StaticResource EqualToHiddenConverter}">
                                                <Binding ElementName="tbManufacturingProcessIDOriginal"
                                                         Path="Text" />
                                                <Binding ElementName="tbManufacturingProcessIDActual"
                                                         Path="Text" />
                                            </MultiBinding>
                                        </TextBlock.Visibility>
                                    </TextBlock>

                                    <TextBlock Text="≠"
                                               Foreground="Blue"
                                               FontSize="10"
                                               VerticalAlignment="Center"
                                               FontWeight="Bold"
                                               Margin="5,-2,0,0"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="lblNotEqual">
                                        <TextBlock.Visibility>
                                            <MultiBinding StringFormat=" {0}, {1}"
                                                          Converter="{StaticResource EqualToHiddenConverter}">
                                                <Binding ElementName="tbManufacturingProcessIDOriginal"
                                                         Path="Text" />
                                                <Binding ElementName="tbManufacturingProcessIDActual"
                                                         Path="Text" />
                                            </MultiBinding>
                                        </TextBlock.Visibility>
                                    </TextBlock>

                                    <TextBlock Text="{Binding ManufacturingProcessID_stCopy}"
                                               Foreground="Green"
                                               FontSize="8"
                                               Margin="5,0,0,0"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbManufacturingProcessIDOriginal">
                                        <TextBlock.Visibility>
                                            <MultiBinding StringFormat=" {0}, {1}"
                                                          Converter="{StaticResource EqualToHiddenConverter}">
                                                <Binding ElementName="tbManufacturingProcessIDOriginal"
                                                         Path="Text" />
                                                <Binding ElementName="tbManufacturingProcessIDActual"
                                                         Path="Text" />
                                            </MultiBinding>
                                        </TextBlock.Visibility>
                                    </TextBlock>



                                </StackPanel>

                                <StackPanel Orientation="Horizontal"
                                            Margin="0,0,0,0"
                                            VerticalAlignment="Bottom">
                                    <Label Content="ManufID:"
                                           FontSize="8"
                                           FontWeight="Normal"
                                           Foreground="#666666"
                                           Margin="0,1,3,0"
                                           Padding="0"
                                           x:Name="lblManufID">
                                        <Label.Visibility>
                                            <MultiBinding StringFormat=" {0}, {1}"
                                                          Converter="{StaticResource EqualToHiddenConverter}">
                                                <Binding ElementName="tbManufacturerIDOriginal"
                                                         Path="Text" />
                                                <Binding ElementName="tbManufacturerIDActual"
                                                         Path="Text" />
                                            </MultiBinding>
                                        </Label.Visibility>
                                    </Label>
                                    <TextBlock Text="{Binding ManufacturerID}"
                                               Foreground="Red"
                                               FontSize="8"
                                               VerticalAlignment="Center"
                                               FontWeight="SemiBold"
                                               Margin="0,1,0,0"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbManufacturerIDOriginal">
                                        <TextBlock.Visibility>
                                            <MultiBinding StringFormat=" {0}, {1}"
                                                          Converter="{StaticResource EqualToHiddenConverter}">
                                                <Binding ElementName="tbManufacturerIDOriginal"
                                                         Path="Text" />
                                                <Binding ElementName="tbManufacturerIDActual"
                                                         Path="Text" />
                                            </MultiBinding>
                                        </TextBlock.Visibility>
                                    </TextBlock>

                                    <TextBlock Text="{Binding ManufacturerID_stCopy}"
                                               Foreground="Green"
                                               FontSize="8"
                                               Margin="5,1,0,0"
                                               FontWeight="SemiBold"
                                               VerticalAlignment="Center"
                                               TextWrapping="WrapWithOverflow"
                                               x:Name="tbManufacturerIDActual">
                                        <TextBlock.Visibility>
                                            <MultiBinding StringFormat=" {0}, {1}"
                                                          Converter="{StaticResource EqualToHiddenConverter}">
                                                <Binding ElementName="tbManufacturerIDOriginal"
                                                         Path="Text" />
                                                <Binding ElementName="tbManufacturerIDActual"
                                                         Path="Text" />
                                            </MultiBinding>
                                        </TextBlock.Visibility>
                                    </TextBlock>



                                </StackPanel>
                            </StackPanel>







                        </Grid>

                    </Border>


                    <ControlTemplate.Triggers>
                        <Trigger Property="ItemsControl.AlternationIndex"
                                 Value="1">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#f7fefe" />
                        </Trigger>

                        <DataTrigger Binding="{Binding ValidateItemIntegrity}"
                                     Value="FailedToValidate">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#ffe" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding ValidateItemIntegrity}"
                                     Value="Invalid">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#feeff2" />
                            <Setter TargetName="tbItem"
                                    Property="Foreground"
                                    Value="Crimson" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding ValidateItemIntegrity}"
                                     Value="Valid">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#f0fef7" />
                        </DataTrigger>

                        <DataTrigger Binding="{Binding ValidateItemIntegrity}"
                                     Value="ChangedItem">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#ecf9ff" />
                            <Setter TargetName="tbItem"
                                    Property="Foreground"
                                    Value="BlueViolet" />
                            <Setter TargetName="tbManufOriginal"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="tbManufActual"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="lblManufActual"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="lblManufOrig"
                                    Property="Content"
                                    Value="Item was changed after scan!" />
                            <Setter TargetName="lblManufOrig"
                                    Property="Foreground"
                                    Value="Maroon" />
                            <Setter TargetName="lblManufOrig"
                                    Property="FontWeight"
                                    Value="SemiBold" />
                            <Setter TargetName="lblManufOrig"
                                    Property="Margin"
                                    Value="0,0,0,2" />
                            <Setter TargetName="tbManufacturingProcessIDActual"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="tbManufacturingProcessIDOriginal"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="tbManufacturerIDActual"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="tbManufacturerIDOriginal"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="lblManufID"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="lblNotEqual"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="lblManufProc"
                                    Property="Visibility"
                                    Value="Collapsed" />

                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvItemImages -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemImages">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <Border x:Name="imageBorder"
                                    Margin="0"
                                    Padding="0">
                                <Image Source="{Binding Path, Converter={StaticResource StringToImageConverter}}"
                                       Tag="{Binding Path}"
                                       x:Name="image"
                                       Height="243"
                                       Width="251"
                                       Margin="4">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="PreviewMouseLeftButtonDown">
                                            <i:InvokeCommandAction Command="{Binding DataContext.ImageClickedCommand, 
                                                                             RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                   CommandParameter="{Binding Path}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </Image>
                            </Border>
                        </Grid>

                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvItemSentOutCases -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemSentOutCases">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1"
                            Tag="{Binding OrderID}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=headerIcon, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerCaseID, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerCrowns, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerAbutments, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerModels, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=headerSentOn, Path=Width}" />
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal">
                                <Image Source="{Binding IconImage}"
                                       Width="30"
                                       Height="30"
                                       Margin="3,-2,2,0"
                                       Grid.Column="0"
                                       VerticalAlignment="Top" />

                            </StackPanel>

                            <StackPanel Grid.Column="1"
                                        HorizontalAlignment="Stretch">
                                <DockPanel HorizontalAlignment="Stretch"
                                           Margin="0">
                                    <TextBlock Text="{Binding OrderID}"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Left"
                                               Margin="5,0,10,0"
                                               FontWeight="SemiBold"
                                               Foreground="{Binding CommentColor}"
                                               TextTrimming="CharacterEllipsis" />

                                    <TextBlock Text="{Binding RushCaseComment}"
                                               VerticalAlignment="Center"
                                               FontWeight="Bold"
                                               Foreground="Crimson"
                                               Margin="0,0,5,0"
                                               HorizontalAlignment="Left"
                                               Visibility="{Binding Rush, Converter={StaticResource RushToVisibleConverter}}"
                                               TextTrimming="CharacterEllipsis" />

                                    <TextBlock Text="{Binding OrderDesignedComment}"
                                               VerticalAlignment="Center"
                                               FontWeight="Bold"
                                               Foreground="Green"
                                               Margin="0,0,5,0"
                                               Visibility="{Binding CommentIcon, Converter={StaticResource CommentIconToVisibleConverter}}"
                                               TextTrimming="CharacterEllipsis" />

                                    <TextBlock Text="{Binding RedoCaseComment}"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Right"
                                               FontWeight="Bold"
                                               Foreground="Purple"
                                               Margin="0,0,5,0"
                                               Visibility="{Binding Redo, Converter={StaticResource RushToVisibleConverter}}"
                                               TextTrimming="CharacterEllipsis" />

                                    <TextBlock Text="{Binding ScrewRetainedCaseComment}"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Right"
                                               FontWeight="Bold"
                                               Foreground="DeepPink"
                                               Margin="0,0,5,0"
                                               Visibility="{Binding ScrewRetained, Converter={StaticResource BoolToVisibilityConverter}}"
                                               TextTrimming="CharacterEllipsis" />

                                </DockPanel>

                                <TextBlock Text="{Binding Items}"
                                           VerticalAlignment="Center"
                                           Margin="5,-2,10,0"
                                           FontSize="8"
                                           Foreground="Gray"
                                           TextTrimming="CharacterEllipsis"
                                           TextWrapping="Wrap" />
                                <TextBlock Text="{Binding Comment}"
                                           VerticalAlignment="Center"
                                           Margin="5,-2,10,0"
                                           FontSize="8"
                                           Foreground="IndianRed"
                                           Visibility="{Binding Comment, Converter={StaticResource TextToVisibilityConverter}}"
                                           TextTrimming="CharacterEllipsis" />
                                <TextBlock Text="{Binding CommentIn3Shape}"
                                           VerticalAlignment="Center"
                                           Margin="5,-2,10,0"
                                           FontSize="8"
                                           Foreground="MediumOrchid"
                                           Cursor="Hand"
                                           Visibility="{Binding CommentIn3Shape, Converter={StaticResource TextToVisibilityConverter}}"
                                           TextTrimming="CharacterEllipsis"
                                           TextWrapping="Wrap" />

                                <TextBlock Text="{Binding RushForMorningComment}"
                                           VerticalAlignment="Center"
                                           FontWeight="Bold"
                                           Margin="5,-2,10,0"
                                           FontSize="8"
                                           Foreground="Crimson"
                                           Visibility="{Binding Rush, Converter={StaticResource RushToVisibleConverter}}"
                                           TextTrimming="CharacterEllipsis" />

                            </StackPanel>

                            <StackPanel Orientation="Horizontal"
                                        VerticalAlignment="Top"
                                        HorizontalAlignment="Left"
                                        Grid.Column="2"
                                        Margin="6,-2,0,0"
                                        Visibility="{Binding Crowns, Converter={StaticResource TextToVisibilityConverter}}">
                                <Grid Visibility="{Binding ScrewRetained, Converter={StaticResource BoolToInverseVisibilityConverter}}">
                                    <Image Source="\Images\SentOutCases\crown.png"
                                           Grid.Column="4"
                                           Width="18"
                                           Height="18"
                                           Margin="0,0,2,0" />
                                </Grid>
                                <Grid Visibility="{Binding ScrewRetained, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <Image Source="\Images\SentOutCases\screwretained.png"
                                           Grid.Column="4"
                                           Width="18"
                                           Height="18"
                                           Margin="0,0,2,0" />
                                </Grid>
                                <TextBlock Text="{Binding Crowns}"
                                           Grid.Column="2"
                                           FontSize="16"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Center" />
                            </StackPanel>

                            <StackPanel Orientation="Horizontal"
                                        VerticalAlignment="Top"
                                        HorizontalAlignment="Left"
                                        Margin="4,-2,0,0"
                                        Grid.Column="3">
                                <Image Source="\Images\SentOutCases\abutment.png"
                                       Grid.Column="4"
                                       Width="18"
                                       Height="18"
                                       Margin="0,2,-1,0"
                                       Visibility="{Binding Abutments, Converter={StaticResource TextToVisibilityConverter}}" />
                                <TextBlock Text="{Binding Abutments}"
                                           Grid.Column="3"
                                           FontSize="16"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Center" />
                            </StackPanel>

                            <Image Source="\Images\SentOutCases\models.png"
                                   Grid.Column="4"
                                   VerticalAlignment="Top"
                                   HorizontalAlignment="Center"
                                   Margin="0,1,0,0"
                                   Width="18"
                                   Height="18"
                                   Visibility="{Binding Models, Converter={StaticResource TextToVisibilityConverter}}" />

                            <StackPanel Grid.Column="5"
                                        VerticalAlignment="Top"
                                        HorizontalAlignment="Center">
                                <TextBlock Text="{Binding SentOn, Converter={StaticResource RemoveFirstCharFromStringIfItsZConverter}}" />
                                <TextBlock Text="{Binding OriginalSentOnForChangedSentOn, Converter={StaticResource RemoveFirstCharFromStringIfItsZConverter}}"
                                           FontSize="10"
                                           HorizontalAlignment="Center"
                                           Foreground="{Binding CommentColor}">
                                    <TextBlock.Visibility>
                                        <MultiBinding StringFormat=" {0}, {1}"
                                                      Converter="{StaticResource EqualToCollapsedVisibilityConverter}">
                                            <Binding Path="SentOn" />
                                            <Binding Path="OriginalSentOnForChangedSentOn" />
                                        </MultiBinding>
                                    </TextBlock.Visibility>
                                </TextBlock>
                            </StackPanel>

                        </Grid>

                    </Border>


                    <ControlTemplate.Triggers>
                        <!--Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter Property="BorderBrush"
                                    Value="#79bbf2"
                                    TargetName="Item" />
                            <Setter Property="Background"
                                    Value="AliceBlue"
                                    TargetName="Item" />
                            <Setter Property="Cursor"
                                    Value="Arrow"
                                    TargetName="Item" />
                        </Trigger-->
                        <Trigger Property="ItemsControl.AlternationIndex"
                                 Value="1">
                            <Setter TargetName="Item"
                                    Property="Background"
                                    Value="#f1fafa" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvItemAccountInfo -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemAccountInfo">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="AccountInfoItem"
                            BorderThickness="1"
                            Tag="{Binding Credentials.Password}"
                            Background="{Binding Color}"
                            Margin="0,5"
                            Padding="2">
                        <Grid Background="#BBB"
                              Height="40">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="6" />
                                <ColumnDefinition Width="40" />
                                <ColumnDefinition Width="250" />
                                <ColumnDefinition />
                                <ColumnDefinition Width="300" />
                            </Grid.ColumnDefinitions>

                            <Rectangle Fill="{Binding Color}" />

                            <Image Source="{Binding ApplicationName, Converter={StaticResource AppNameToIconConverter}}"
                                   Width="24"
                                   Height="24"
                                   Grid.Column="1" />

                            <StackPanel Grid.Column="2"
                                        VerticalAlignment="Center">

                                <TextBlock Text="{Binding FriendlyName}"
                                           Foreground="Black"
                                           FontWeight="Normal"
                                           FontSize="16"
                                           Margin="5,0,0,0"
                                           TextTrimming="CharacterEllipsis" />

                                <TextBlock Text="{Binding SubCategory}"
                                           Foreground="Green"
                                           VerticalAlignment="Center"
                                           FontWeight="Thin"
                                           FontSize="9"
                                           Margin="5,-2,0,0"
                                           TextTrimming="CharacterEllipsis" />

                            </StackPanel>

                            <Grid Grid.Column="3">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="20" />
                                    <ColumnDefinition Width="180" />
                                    <ColumnDefinition Width="100" />
                                    <ColumnDefinition Width="100" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Image Grid.Row="0"
                                       Source="\Images\AccountInfoIcons\user.png"
                                       Width="10"
                                       Height="10" />

                                <TextBlock Text="{Binding Credentials.UserName}"
                                           Grid.Row="0"
                                           Grid.Column="1"
                                           FontSize="11"
                                           Foreground="Green"
                                           VerticalAlignment="Center"
                                           TextTrimming="CharacterEllipsis"
                                           Margin="0,0,4,0" />

                                <Image Grid.Row="1"
                                       Source="\Images\AccountInfoIcons\key.png"
                                       Width="10"
                                       Height="10" />

                                <TextBlock Text="------"
                                           Tag="{Binding Credentials.Password}"
                                           Grid.Row="1"
                                           Grid.Column="1"
                                           FontSize="12"
                                           Foreground="Blue"
                                           VerticalAlignment="Center"
                                           TextTrimming="CharacterEllipsis"
                                           Margin="0,0,4,0" />

                                <Button Content="Copy Username"
                                        Grid.Row="0"
                                        Grid.Column="2"
                                        FontSize="9"
                                        Margin="2"
                                        Command="{Binding DataContext.CopyUserNameToClipboardCommand, 
                                                          RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                        CommandParameter="{Binding Credentials.UserName}" />

                                <Button Content="Copy Password"
                                        Grid.Row="1"
                                        Grid.Column="2"
                                        FontSize="9"
                                        Margin="2"
                                        Command="{Binding DataContext.CopyPasswordToClipboardCommand, 
                                                          RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                        CommandParameter="{Binding Credentials.Password}" />

                                <Button Content="Show Password"
                                        Grid.Row="1"
                                        Grid.Column="3"
                                        FontSize="9"
                                        Margin="2"
                                        Tag="{Binding Credentials.Password}"
                                        Click="AccountInfosShowPassword_Button_Click" />

                            </Grid>



                            <Button Grid.Column="4"
                                    Margin="3"
                                    Height="25"
                                    Visibility="{Binding ApplicationName, Converter={StaticResource EmptyAppNameToVisibleConverter}}"
                                    Command="{Binding DataContext.OpenWebsiteCommand, 
                                              RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                    CommandParameter="{Binding Website}">
                                <Button.Content>
                                    <Grid Width="250">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="25" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <Image Source="{Binding ApplicationName, Converter={StaticResource AppNameToIconConverter}}"
                                               Width="16"
                                               Height="16"
                                               Margin="0,2,0,0"
                                               Grid.Column="0" />

                                        <TextBlock Grid.Column="1"
                                                   Text="{Binding FriendlyName, StringFormat='Open \{0} website', Converter={StaticResource EmailToWebsiteConverter}}" />
                                    </Grid>
                                </Button.Content>
                            </Button>

                            <Button Grid.Column="4"
                                    Margin="3"
                                    Height="25"
                                    Visibility="{Binding ApplicationName, Converter={StaticResource EmptyAppNameToCollapsedConverter}}"
                                    Command="{Binding DataContext.StartApplicationCommand, 
                                                      RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                    CommandParameter="{Binding ApplicationPath}">
                                <Button.Content>
                                    <Grid Width="250">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="25" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>

                                        <Image Source="{Binding ApplicationName, Converter={StaticResource AppNameToIconConverter}}"
                                               Width="16"
                                               Height="16"
                                               Grid.Column="0" />

                                        <TextBlock Grid.Column="1"
                                                   Text="{Binding ApplicationName, StringFormat='Start \{0}'}" />
                                    </Grid>
                                </Button.Content>
                            </Button>
                        </Grid>

                    </Border>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter Property="BorderBrush"
                                    Value="#99c5ff"
                                    TargetName="AccountInfoItem" />
                            <Setter Property="Background"
                                    Value="#005475"
                                    TargetName="AccountInfoItem" />
                        </Trigger>
                        <Trigger Property="ItemsControl.AlternationIndex"
                                 Value="1">
                            <Setter TargetName="AccountInfoItem"
                                    Property="Background"
                                    Value="#777" />
                        </Trigger>
                    </ControlTemplate.Triggers>

                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvSentHealthReports -->
    <Style TargetType="ListViewItem"
           x:Key="LvSentHealthReports">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1">

                        <Grid Margin="1,0,1,6"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition  Width="{Binding ElementName=serviceHealthListTaskName, Path=Width}" />
                            </Grid.ColumnDefinitions>

                            <Grid HorizontalAlignment="Right">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="28" />
                                </Grid.ColumnDefinitions>



                                <TextBlock Text="{Binding TaskName}"
                                           Foreground="{Binding ForeColor}"
                                           HorizontalAlignment="Right"
                                           FontWeight="Normal"
                                           FontSize="11"
                                           TextTrimming="CharacterEllipsis"
                                           Margin="0,0,0,0"
                                           Padding="10,2,0,4"
                                           Grid.Column="0" />

                                <StackPanel Grid.Row="1"
                                            Grid.Column="0"
                                            HorizontalAlignment="Right">
                                    <TextBlock Text="{Binding ServiceStatus}"
                                               Foreground="LightYellow"
                                               FontWeight="Normal"
                                               FontSize="9"
                                               HorizontalAlignment="Right"
                                               TextTrimming="CharacterEllipsis"
                                               Margin="0,-7,0,0"
                                               Padding="11,2,0,4" />

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Last report:"
                                                   Foreground="#DDD"
                                                   FontWeight="Normal"
                                                   FontSize="8"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="5,-6,0,0"
                                                   Padding="2,2,2,0" />
                                        <TextBlock Text="{Binding LastReport, Converter={StaticResource DateToMinutesConverter}}"
                                                   Foreground="#e1e3aa"
                                                   FontWeight="Normal"
                                                   FontSize="8"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="0,-6,0,0"
                                                   Padding="2,2,2,0" />
                                    </StackPanel>

                                </StackPanel>

                                <Image Source="{Binding ServiceStatus, Converter={StaticResource ServiceStatusToIconConverter}}"
                                       Margin="4,2,-6,0"
                                       Grid.RowSpan="2"
                                       Width="28"
                                       Height="28"
                                       VerticalAlignment="Top"
                                       Grid.Column="1" />
                            </Grid>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- LvItemMainMenu -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemMainMenu">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            Cursor="Hand"
                            BorderThickness="1">

                        <Grid Margin="1,0,1,6"
                              Visibility="{Binding Visible}"
                              HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition  Width="{Binding ElementName=mainMenuItemIcon, Path=Width}" />
                                <ColumnDefinition  Width="{Binding ElementName=mainMenuItemText, Path=Width}" />
                            </Grid.ColumnDefinitions>



                            <Image Source="{Binding Icon}"
                                   Margin="0,2,0,0"
                                   Width="16"
                                   Height="16"
                                   VerticalAlignment="Top"
                                   Grid.Column="0" />


                            <TextBlock Text="{Binding Header}"
                                       HorizontalAlignment="Left"
                                       FontWeight="Normal"
                                       FontSize="12"
                                       TextTrimming="CharacterEllipsis"
                                       Margin="0,0,0,0"
                                       Padding="5,2,0,0"
                                       Grid.Column="1" />



                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="True">
                            <Setter Property="BorderBrush"
                                    Value="#99c5ff"
                                    TargetName="Item" />
                            <Setter Property="Background"
                                    Value="#330295cf"
                                    TargetName="Item" />
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- LvImportHistoryAnnouncement -->
    <Style TargetType="ListViewItem"
           x:Key="LvImportHistoryAnnouncement">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1"
                            Visibility="{Binding AgeInSeconds, Converter={StaticResource AgeSecondsToCollapsedVisibilityConverter}}">

                        <Grid Margin="1,0,1,10">

                            <StackPanel Orientation="Horizontal">

                                <core:OutlinedTextBlock Stroke="Black"
                                                        StrokePosition="Outside"
                                                        FontSize="{Binding Multiplier, Converter={StaticResource Double12ToMultiplyConverter}}"
                                                        FontWeight="SemiBold"
                                                        Fill="#42ff48"
                                                        StrokeThickness="1"
                                                        Text="{Binding OrderID}"
                                                        VerticalAlignment="Center"
                                                        HorizontalAlignment="Right"
                                                        Margin="15,0,15,0"
                                                        Grid.Row="0" />
                                <StackPanel>
                                    <core:OutlinedTextBlock Stroke="Black"
                                                            StrokePosition="Outside"
                                                            FontSize="{Binding Multiplier, Converter={StaticResource Double8ToMultiplyConverter}}"
                                                            FontWeight="SemiBold"
                                                            Fill="#529f68"
                                                            StrokeThickness="1"
                                                            Text="{Binding Event}"
                                                            VerticalAlignment="Center"
                                                            HorizontalAlignment="Left"
                                                            Margin="15,0,15,-10"
                                                            Grid.Row="1" />
                                    <core:OutlinedTextBlock Stroke="Black"
                                                            StrokePosition="Outside"
                                                            FontSize="{Binding Multiplier, Converter={StaticResource Double10ToMultiplyConverter}}"
                                                            FontWeight="SemiBold"
                                                            Fill="#f2ff48"
                                                            StrokeThickness="1"
                                                            Text="{Binding FriendlyName}"
                                                            VerticalAlignment="Center"
                                                            HorizontalAlignment="Right"
                                                            Margin="15,0,15,0"
                                                            Grid.Row="2" />
                                </StackPanel>
                            </StackPanel>






                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- LvAvailablePanNumberCountList -->
    <Style TargetType="ListViewItem"
           x:Key="LvAvailablePanNumberCountList">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1">

                        <Grid Margin="1,0,1,5">

                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>




                            <core:OutlinedTextBlock Stroke="Black"
                                                    StrokePosition="Outside"
                                                    FontSize="{Binding NumberFontSize}"
                                                    FontWeight="SemiBold"
                                                    Fill="#42ff48"
                                                    StrokeThickness="1"
                                                    Text="{Binding Count}"
                                                    VerticalAlignment="Center"
                                                    HorizontalAlignment="Center"
                                                    Margin="15,0,15,0"
                                                    Grid.Row="1" />

                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Center"
                                        Margin="0,-30,0,0"
                                        Grid.Row="2">

                                <core:OutlinedTextBlock Stroke="Black"
                                                        StrokePosition="Outside"
                                                        FontSize="{Binding NamesFontSize}"
                                                        FontWeight="SemiBold"
                                                        Fill="#f2ff48"
                                                        StrokeThickness="1"
                                                        Text="{Binding FriendlyName}"
                                                        VerticalAlignment="Center"
                                                        HorizontalAlignment="Left"
                                                        Margin="15,0,15,0"
                                                        Grid.Row="2" />
                                <core:OutlinedTextBlock Stroke="Black"
                                                        StrokePosition="Outside"
                                                        FontSize="{Binding NamesFontSize}"
                                                        FontWeight="SemiBold"
                                                        Fill="#529f68"
                                                        StrokeThickness="1"
                                                        Text="{Binding ComputerName, StringFormat='[{0}]'}"
                                                        VerticalAlignment="Center"
                                                        HorizontalAlignment="Right"
                                                        Margin="5,0,15,0" />
                            </StackPanel>








                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- LvItemPrescriptionInconsistencys -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemPrescriptionInconsistencys">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="IncostistencyBorder"
                            BorderThickness="1">

                        <Grid Margin="1,2,1,2">

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50" />
                                <ColumnDefinition />
                                <ColumnDefinition />

                            </Grid.ColumnDefinitions>


                            <TextBlock FontWeight="SemiBold"
                                       Text="{Binding PanNumber}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="3,0,15,0"
                                       x:Name="tbiPanNumber"
                                       Grid.Column="0">
                                <TextBlock.Foreground>
                                    <MultiBinding StringFormat=" {0}, {1}, {2}"
                                                  Converter="{StaticResource IncostistencyToColorConverterConverter}">
                                        <Binding Path="PanNumber" />
                                        <Binding Path="OrderID" />
                                        <Binding Path="Ignored" />
                                    </MultiBinding>
                                </TextBlock.Foreground>
                            </TextBlock>


                            <TextBlock FontWeight="SemiBold"
                                       Text="{Binding OrderID}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left"
                                       Margin="0,0,0,0"
                                       Cursor="Hand"
                                       x:Name="tbiOrderID"
                                       Grid.Column="1">
                                <TextBlock.Foreground>
                                    <MultiBinding StringFormat=" {0}, {1}, {2}"
                                                  Converter="{StaticResource IncostistencyToColorConverterConverter}">
                                        <Binding Path="PanNumber" />
                                        <Binding Path="OrderID" />
                                        <Binding Path="Ignored" />
                                    </MultiBinding>
                                </TextBlock.Foreground>
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="MouseDown">
                                        <i:InvokeCommandAction Command="{Binding DataContext.InconsistencyItemClickedCommand, 
                                                                         RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                               CommandParameter="{Binding OrderID}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                                <TextBlock.Visibility>
                                    <MultiBinding StringFormat=" {0}, {1}, {2}"
                                                  Converter="{StaticResource IncostistencyToVisibilityCollapsedConverterConverter}">
                                        <Binding Path="PanNumber" />
                                        <Binding Path="OrderID" />
                                        <Binding Path="Ignored" />
                                    </MultiBinding>
                                </TextBlock.Visibility>
                            </TextBlock>

                            <TextBlock FontWeight="SemiBold"
                                       Text="{Binding OrderID}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left"
                                       Margin="0,0,0,0"
                                       Grid.Column="1">
                                <TextBlock.Foreground>
                                    <MultiBinding StringFormat=" {0}, {1}, {2}"
                                                  Converter="{StaticResource IncostistencyToColorConverterConverter}">
                                        <Binding Path="PanNumber" />
                                        <Binding Path="OrderID" />
                                        <Binding Path="Ignored" />
                                    </MultiBinding>
                                </TextBlock.Foreground>
                                <TextBlock.Visibility>
                                    <MultiBinding StringFormat=" {0}, {1}, {2}"
                                                  Converter="{StaticResource IncostistencyToVisibilityVisibleConverterConverter}">
                                        <Binding Path="PanNumber" />
                                        <Binding Path="OrderID" />
                                        <Binding Path="Ignored" />
                                    </MultiBinding>
                                </TextBlock.Visibility>
                            </TextBlock>

                            <TextBlock FontWeight="SemiBold"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0,0,0,0"
                                       Foreground="Yellow"
                                       Text="Missing prescription!"
                                       d:Visibility="Visible"
                                       Visibility="{Binding PanNumber, Converter={StaticResource EmptyTextToVisibleConverter}}"
                                       Grid.Column="2" />

                            <TextBlock FontWeight="SemiBold"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right"
                                       Margin="0,0,0,0"
                                       Foreground="#FFA300"
                                       Text="Missing 3Shape Order!"
                                       d:Visibility="Visible"
                                       Visibility="{Binding OrderID, Converter={StaticResource EmptyTextToVisibleConverter}}"
                                       Grid.Column="2" />



                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>
                        <Trigger Property="ItemsControl.AlternationIndex"
                                 Value="1">
                            <Setter TargetName="IncostistencyBorder"
                                    Property="Background"
                                    Value="#66777777" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvItemPrescriptionMakerEventsList -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemPrescriptionMakerEventsList">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="EventBorder"
                            BorderThickness="1">

                        <Grid Margin="1,2,1,2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal">

                                <TextBlock FontWeight="SemiBold"
                                           Text="["
                                           Foreground="#EEE"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="0"
                                           FontSize="12">
                                </TextBlock>
                                <TextBlock FontWeight="SemiBold"
                                           Text="{Binding TimeStr}"
                                           Foreground="#222"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="1"
                                           FontSize="12">
                                </TextBlock>

                                <TextBlock FontWeight="SemiBold"
                                           Text="]"
                                           Foreground="#EEE"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="0,0,0,0"
                                           FontSize="12">
                                </TextBlock>
                            </StackPanel>

                            <TextBlock FontWeight="SemiBold"
                                       Text="{Binding EventStr}"
                                       Foreground="{Binding Color, Converter={StaticResource EventColorToColorConverter}}"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Left"
                                       Margin="8,0,15,0"
                                       FontSize="14"
                                       x:Name="tbiPanNumber"
                                       Grid.Column="1">
                            </TextBlock>


                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>
                        <Trigger Property="ItemsControl.AlternationIndex"
                                 Value="1">
                            <Setter TargetName="EventBorder"
                                    Property="Background"
                                    Value="#55777777" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- LvItemDuplicates -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemDuplicates">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            Background="#999"
                            BorderThickness="1"
                            Margin="0,0,0,10">

                        <Grid Margin="1,0,1,2">

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="110" />
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>


                            <core:OutlinedTextBlock Stroke="Black"
                                                    StrokePosition="Outside"
                                                    FontSize="28"
                                                    FontWeight="SemiBold"
                                                    Fill="#f25f08"
                                                    StrokeThickness="1"
                                                    Text="{Binding PanNr}"
                                                    VerticalAlignment="Top"
                                                    HorizontalAlignment="Center"
                                                    Margin="0,-5,0,0"
                                                    Grid.Row="0"
                                                    Grid.Column="0"
                                                    Grid.RowSpan="2" />

                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="1"
                                        Grid.Row="0">
                                <TextBlock Text="Order 1:"
                                           VerticalAlignment="Center" />
                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#115500"
                                           Text="{Binding OrderID_1}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="5,0,15,0" />
                            </StackPanel>


                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="1"
                                        Grid.Row="1">
                                <TextBlock Text="Order 2:"
                                           VerticalAlignment="Center" />
                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#551000"
                                           Text="{Binding OrderID_2}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="5,0,15,0" />
                            </StackPanel>



                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="2"
                                        Grid.Row="0">
                                <TextBlock Text="Customer:"
                                           VerticalAlignment="Center" />
                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#115500"
                                           Text="{Binding Customer_1}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="5,0,15,0" />

                            </StackPanel>

                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="2"
                                        Grid.Row="1">
                                <TextBlock Text="Customer:"
                                           VerticalAlignment="Center" />
                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#551000"
                                           Text="{Binding Customer_2}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="5,0,15,0" />
                            </StackPanel>



                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="3"
                                        Grid.Row="0">
                                <TextBlock Text="Pt:"
                                           VerticalAlignment="Center" />
                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#115500"
                                           Text="{Binding Patient_FirstName_1}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="5,0,10,0" />

                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#115500"
                                           Text="{Binding Patient_LastName_1}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="0,0,15,0" />
                            </StackPanel>




                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="3"
                                        Grid.Row="1">
                                <TextBlock Text="Pt:"
                                           VerticalAlignment="Center" />
                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#551000"
                                           Text="{Binding Patient_FirstName_2}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="5,0,10,0" />

                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#551000"
                                           Text="{Binding Patient_LastName_2}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Left"
                                           Margin="0,0,15,0" />
                            </StackPanel>


                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="4"
                                        Grid.Row="0"
                                        HorizontalAlignment="Right">
                                <TextBlock Text="Created:"
                                           VerticalAlignment="Center" />
                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#115500"
                                           Text="{Binding Created_1}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="5,0,15,0" />
                            </StackPanel>


                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="4"
                                        Grid.Row="1"
                                        HorizontalAlignment="Right">
                                <TextBlock Text="Created:"
                                           VerticalAlignment="Center" />
                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#551000"
                                           Text="{Binding Created_2}"
                                           VerticalAlignment="Center"
                                           HorizontalAlignment="Right"
                                           Margin="5,0,15,0" />
                            </StackPanel>



                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvItemArchives -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemArchives">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="1"
                            BorderBrush="#CCC"
                            Background="#02FFFFFF"
                            
                            Padding="2"
                            CornerRadius="5"
                            Margin="3,2,0,3">

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="{Binding ElementName=archeaderIcon, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=archeaderCaseID, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=archeaderButtons, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=archeaderDesigner, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=archeaderYear, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=archeaderCustomer, Path=Width}" />
                                <ColumnDefinition Width="{Binding ElementName=archeaderDates, Path=Width}" />
                            </Grid.ColumnDefinitions>

                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>


                            <Image Source="{Binding Icon}"
                                   Width="26"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Top"
                                   Margin="0,0,2,0"
                                   Grid.Column="0"
                                   Grid.RowSpan="2" />


                            <TextBlock Text="{Binding OrderID}"
                                       FontSize="14"
                                       Grid.Column="1"
                                       Grid.Row="0" />

                            <StackPanel Grid.Column="1"
                                        Grid.Row="1">

                                <TextBlock Text="{Binding Items}"
                                           FontSize="10"
                                           HorizontalAlignment="Left"
                                           TextWrapping="Wrap"
                                           Width="450"
                                           Foreground="#555" />

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="PanNr: "
                                               FontSize="11"
                                               Foreground="MediumPurple" />
                                    <TextBlock Text="{Binding PanNumber}"
                                               FontSize="11"
                                               FontWeight="Bold"
                                               Foreground="DeepPink" />
                                </StackPanel>

                                <TextBlock Text="{Binding BaseFolder}"
                                           FontSize="8"
                                           Cursor="Hand"
                                           Margin="-5,0,0,0"
                                           TextWrapping="Wrap"
                                           Width="450"
                                           Foreground="#BBB">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="PreviewMouseDown">
                                            <i:InvokeCommandAction Command="{Binding DataContext.ArchivesBaseFolderItemClickedCommand, 
            RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                  CommandParameter="{Binding .}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </TextBlock>

                                <TextBlock Text="{Binding ReasonIsDead}"
                                           FontSize="10"
                                           Foreground="Red" />
                            </StackPanel>


                            <!-- Buttons -->
                            <StackPanel Grid.Column="2"
                                        Grid.RowSpan="2"
                                        VerticalAlignment="Top"
                                        d:Visibility="Visible"
                                        Visibility="Hidden"
                                        x:Name="arctsButtonPanel">
                                <StackPanel HorizontalAlignment="Center"
                                            Cursor="Hand"
                                            Margin="-10,0,0,0">
                                    <Image Source="/Images/Other/download.png"
                                           Width="40"
                                           Height="42">
                                        <i:Interaction.Triggers>

                                            <i:EventTrigger EventName="PreviewMouseDown">
                                                <i:InvokeCommandAction Command="{Binding DataContext.ArchivesItemClickedCommand, 
                 RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                                       CommandParameter="{Binding .}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </Image>

                                    <TextBlock Text="Generate Zipped Order"
                                               FontSize="9" />

                                </StackPanel>
                            </StackPanel>

                            <StackPanel Grid.Column="4"
                                        Grid.RowSpan="2">

                                <TextBlock Text="YEAR"
                                           Foreground="DeepPink"
                                           FontSize="8"
                                           Margin="22,0,0,-8"
                                           HorizontalAlignment="Center" />
                                <TextBlock Text="{Binding CreateYear}"
                                           Foreground="Firebrick"
                                           FontSize="20"
                                           HorizontalAlignment="Center" />
                            </StackPanel>


                            <StackPanel Grid.Column="5"
                                        Grid.RowSpan="2">

                                <TextBlock Text="{Binding Customer}"
                                           Foreground="ForestGreen" />

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Patient_FirstName}"
                                               FontSize="11" />
                                    <TextBlock Text="{Binding Patient_LastName}"
                                               Margin="4,0,0,0"
                                               Foreground="Purple"
                                               FontSize="11" />
                                </StackPanel>

                                <TextBlock Text="{Binding CreateDate}"
                                           Foreground="DeepPink" />
                            </StackPanel>



                            <Grid Grid.Column="6"
                                  Grid.RowSpan="2">

                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Added to Datastore"
                                                   FontSize="10"
                                                   Foreground="Green"
                                                   Margin="0,0,4,0"
                                                   Grid.Column="0"
                                                   Grid.Row="0" />
                                        <TextBlock Text="{Binding Registered}"
                                                   FontSize="10"
                                                   Grid.Column="1"
                                                   Grid.Row="0" />


                                        <TextBlock Text="Design Module"
                                                   FontSize="10"
                                                   Foreground="BlueViolet"
                                                   Margin="0,0,4,0"
                                                   Grid.Column="0"
                                                   Grid.Row="1" />
                                        <TextBlock Text="{Binding DesignModuleID}"
                                                   FontSize="10"
                                                   Grid.Column="1"
                                                   Grid.Row="1" />


                                        <TextBlock Text="Dental Version"
                                                   FontSize="10"
                                                   Foreground="Orange"
                                                   Margin="0,0,4,0"
                                                   Grid.Column="0"
                                                   Grid.Row="2" />
                                        <TextBlock Text="{Binding DentalVersion}"
                                                   FontSize="10"
                                                   Foreground="Green"
                                                   Grid.Column="1"
                                                   Grid.Row="2" />
                                        
                                        
                                        <TextBlock Text="Order State Is"
                                                   FontSize="10"
                                                   Foreground="#36494F"
                                                   Margin="0,0,4,0"
                                                   Grid.Column="0"
                                                   Grid.Row="3" />
                                        <TextBlock Text="{Binding ProcessStatusID, Converter={StaticResource ProcessStatusIDToReadableStateConverter}}"
                                                   FontSize="10"
                                                   Foreground="SteelBlue"
                                                   Grid.Column="1"
                                                   Grid.Row="3" />
                                    </Grid>


                                </StackPanel>

                                <Border Height="50"
                                        ClipToBounds="True"
                                        Width="100"
                                        HorizontalAlignment="Right">

                                    <TextBlock Text="{Binding Id}"
                                               FontSize="74"
                                               Margin="-30,-25,4,0"
                                               Foreground="Orange"
                                               Opacity="0.20"
                                               HorizontalAlignment="Right" />
                                </Border>
                            </Grid>

                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>





                        <Trigger Property="IsMouseOver"
                                 Value="True">


                            <Setter Property="Visibility"
                                    Value="Visible"
                                    TargetName="arctsButtonPanel" />
                        </Trigger>



                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <!-- LvItemGlobalSearch -->
    <Style TargetType="ListViewItem"
           x:Key="LvItemGlobalSearch">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="Item"
                            BorderThickness="0,0,0,1"
                            BorderBrush="#CCC"
                            Background="{Binding Background}"
                            Cursor="Hand"
                            Padding="2"
                            Margin="0,0,0,0">

                        <i:Interaction.Triggers>

                            <i:EventTrigger EventName="PreviewMouseDown">
                                <i:InvokeCommandAction Command="{Binding DataContext.GsItemClickedCommand, 
                                         RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"
                                                       CommandParameter="{Binding .}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                        <Grid Margin="0,5">
                            <TextBlock Text="{Binding Id}"
                                       FontSize="60"
                                       FontWeight="Bold"
                                       Foreground="#16111177"
                                       Margin="0,-20"
                                       HorizontalAlignment="Right"
                                       VerticalAlignment="Center" />

                            <TextBlock FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="#559955"
                                       Text="{Binding CreateYear}"
                                       VerticalAlignment="Top"
                                       HorizontalAlignment="Right"
                                       Margin="0,-4,7,0"
                                       Grid.Column="3"
                                       Grid.Row="0" />

                            <Grid Margin="1,0,1,2">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50" />
                                    <ColumnDefinition Width="120" />
                                    <ColumnDefinition Width="510" />
                                    <ColumnDefinition Width="auto" />
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>


                                <Image Source="{Binding Icon}"
                                       VerticalAlignment="Top"
                                       HorizontalAlignment="Left"
                                       Width="20"
                                       Margin="0,-4,0,18"
                                       Grid.RowSpan="2" />

                                <TextBlock FontSize="18"
                                           FontWeight="SemiBold"
                                           Foreground="#f25f08"
                                           Text="{Binding PanNumber}"
                                           VerticalAlignment="Bottom"
                                           HorizontalAlignment="Left"
                                           Margin="0,-5,0,0"
                                           Grid.Row="0"
                                           Grid.Column="0"
                                           Grid.RowSpan="3" />

                                <TextBlock FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="#000"
                                           Text="{Binding IntOrderId}"
                                           VerticalAlignment="Top"
                                           HorizontalAlignment="Left"
                                           Margin="0,-5,0,0"
                                           Width="475"
                                           TextWrapping="Wrap"
                                           Grid.Row="0"
                                           Grid.Column="1"
                                           Grid.ColumnSpan="2" />





                                <TextBlock FontSize="11"
                                           FontWeight="SemiBold"
                                           Foreground="#559955"
                                           Text="{Binding CreateDate}"
                                           VerticalAlignment="Top"
                                           HorizontalAlignment="Left"
                                           Margin="0,-4,0,0"
                                           Grid.Column="1"
                                           Grid.Row="1" />

                                <StackPanel Orientation="Horizontal"
                                            HorizontalAlignment="Left"
                                            Margin="0,-4,0,0"
                                            Grid.Column="2"
                                            Grid.Row="1">

                                    <TextBlock FontSize="11"
                                               FontWeight="SemiBold"
                                               Foreground="#555599"
                                               Text="{Binding Patient_FirstName}"
                                               VerticalAlignment="Top"
                                               HorizontalAlignment="Left" />
                                    <TextBlock FontSize="11"
                                               FontWeight="SemiBold"
                                               Foreground="#995555"
                                               Text="{Binding Patient_LastName}"
                                               VerticalAlignment="Top"
                                               HorizontalAlignment="Left"
                                               Margin="3,0,0,0" />
                                </StackPanel>


                                <TextBlock FontSize="9"
                                           FontWeight="SemiBold"
                                           Foreground="#888"
                                           Text="{Binding Items}"
                                           VerticalAlignment="Top"
                                           HorizontalAlignment="Left"
                                           Margin="0,-2,0,0"
                                           Grid.Column="1"
                                           Grid.Row="2"
                                           Grid.ColumnSpan="2" />


                            </Grid>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Themes/ControlStyles.xaml" />
    </ResourceDictionary.MergedDictionaries>

</ResourceDictionary>